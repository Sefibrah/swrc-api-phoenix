"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[349],{40784:(A,f,t)=>{t.d(f,{r:()=>T});var e=t(85893),n=t(16607),r=t(99168),v=t.n(r);function w(c,u,g){if(!c||!u||!g)return{display:"none"};const{x:a,y:s}=g;return{transform:`translate(${a}px, ${s}px)`}}const T=({renderItem:c})=>{const{itemType:u,isDragging:g,item:a,initialOffset:s,currentOffset:o,mouseOffset:O}=(0,r.useDragLayer)(d=>({item:d.getItem(),itemType:d.getItemType(),initialOffset:d.getInitialSourceClientOffset(),currentOffset:d.getSourceClientOffset(),isDragging:d.isDragging(),mouseOffset:d.getClientOffset()}));return g?(0,e.jsx)(n.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%",children:(0,e.jsx)(n.x,{style:w(s,o,O),children:c({type:u,item:a})})}):null}},75021:(A,f,t)=>{t.d(f,{q:()=>v});var e=t(67294),n=t(32638),r=t(88767);function v({enabled:w}={enabled:!0}){const{get:T}=(0,n.useFetchClient)(),{data:c,isError:u,isLoading:g}=(0,r.useQuery)(["ee","license-limit-info"],async()=>{const{data:{data:o}}=await T("/admin/license-limit-information");return o},{enabled:w}),a=e.useMemo(()=>c??{},[c]),s=e.useCallback(o=>(a?.features??[]).find(d=>d.name===o)?.options??{},[a?.features]);return{license:a,getFeature:s,isError:u,isLoading:g}}},43390:(A,f,t)=>{t.d(f,{eJ:()=>W,lx:()=>D,h4:()=>m,fC:()=>P});var e=t(67294),n=t(71590),r=t(40720),v=t(34726),w=t(90731),T=t(32638),c=t(97695),u=t(86896),g=t(40784),a=t(86978),s=t(96987),o=t(71068),O=t(58471),d=t(45697),L=t.n(d),h=t(71997);const R=(0,h.ZP)(s.k)`
  svg path {
    fill: ${({theme:E})=>E.colors.neutral600};
  }
`;function C({name:E}){return e.createElement(s.k,{background:"primary100",borderStyle:"dashed",borderColor:"primary600",borderWidth:"1px",gap:3,hasRadius:!0,padding:3,shadow:"tableShadow",width:(0,T.pxToRem)(300)},e.createElement(R,{alignItems:"center",background:"neutral200",borderRadius:"50%",height:6,justifyContent:"center",width:6},e.createElement(O.Z,{width:`${8/16}rem`})),e.createElement(o.Z,{fontWeight:"bold"},E))}C.propTypes={name:L().string.isRequired};function S({type:E,item:y}){switch(E){case a.uL.STAGE:return e.createElement(C,{...y});default:return null}}function D(){return e.createElement(g.r,{renderItem:S})}function P({children:E}){return e.createElement(n.A,null,e.createElement(r.o,{tabIndex:-1},e.createElement(v.D,null,E)))}function W({href:E}){const{formatMessage:y}=(0,u.Z)();return e.createElement(T.Link,{startIcon:e.createElement(c.Z,null),to:E},y({id:"global.back",defaultMessage:"Back"}))}function m({title:E,subtitle:y,navigationAction:M,primaryAction:p}){return e.createElement(e.Fragment,null,e.createElement(T.SettingsPageTitle,{name:E}),e.createElement(w.T,{navigationAction:M,primaryAction:p,title:E,subtitle:y}))}},38705:(A,f,t)=>{t.d(f,{uT:()=>S,fC:()=>W,Dx:()=>C});var e=t(67294),n=t(71068),r=t(96987),v=t(74622),w=t(71543),T=t(16607),c=t(96208),u=t(94101),g=t(35771),a=t(45697),s=t.n(a),o=t(86896),O=t(71997);const d=t.p+"0cd5f8915b265d5b1856.png",L="limits-title",h="https://strapi.io/pricing-cloud",R="https://strapi.io/contact-sales";function C({children:m}){return e.createElement(n.Z,{variant:"alpha",id:L},m)}C.propTypes={children:s().node.isRequired};function S({children:m}){return e.createElement(n.Z,{variant:"omega"},m)}S.propTypes={children:s().node.isRequired};function D(){const{formatMessage:m}=(0,o.Z)();return e.createElement(r.k,{gap:2,paddingTop:4},e.createElement(u.Q,{variant:"default",isExternal:!0,href:h},m({id:"Settings.review-workflows.limit.cta.learn",defaultMessage:"Learn more"})),e.createElement(u.Q,{variant:"tertiary",isExternal:!0,href:R},m({id:"Settings.review-workflows.limit.cta.sales",defaultMessage:"Contact Sales"})))}const P=O.ZP.img`
  // Margin top|right reverse the padding of ModalBody
  margin-right: ${({theme:m})=>`-${m.spaces[7]}`};
  margin-top: ${({theme:m})=>`-${m.spaces[7]}`};
  width: 360px;
`;function W({children:m,isOpen:E,onClose:y}){const{formatMessage:M}=(0,o.Z)();return E?e.createElement(v.P,{labelledBy:L},e.createElement(w.f,null,e.createElement(r.k,{gap:2,paddingLeft:7,position:"relative"},e.createElement(r.k,{alignItems:"start",direction:"column",gap:2,width:"60%"},m,e.createElement(D,null)),e.createElement(r.k,{justifyContent:"end",height:"100%",width:"40%"},e.createElement(P,{src:d,"aria-hidden":!0,alt:"",loading:"lazy"}),e.createElement(T.x,{display:"flex",position:"absolute",right:0,top:0},e.createElement(c.h,{icon:e.createElement(g.Z,null),"aria-label":M({id:"global.close",defaultMessage:"Close"}),onClick:y})))))):null}W.defaultProps={isOpen:!1},W.propTypes={children:s().node.isRequired,isOpen:s().bool,onClose:s().func.isRequired}},86978:(A,f,t)=>{t.d(f,{$k:()=>d,Ef:()=>S,FT:()=>R,Nj:()=>o,Ot:()=>a,QM:()=>u,VS:()=>L,_X:()=>D,bc:()=>s,gu:()=>r,k_:()=>O,lv:()=>h,qZ:()=>c,rg:()=>w,sN:()=>n,uL:()=>C,x4:()=>g,yq:()=>v,zn:()=>T});var e=t(12255);const n="settings_review-workflows",r="Settings/Review_Workflows/RESET_WORKFLOW",v="Settings/Review_Workflows/SET_CONTENT_TYPES",w="Settings/Review_Workflows/SET_IS_LOADING",T="Settings/Review_Workflows/SET_ROLES",c="Settings/Review_Workflows/SET_WORKFLOW",u="Settings/Review_Workflows/SET_WORKFLOWS",g="Settings/Review_Workflows/WORKFLOW_DELETE_STAGE",a="Settings/Review_Workflows/WORKFLOW_ADD_STAGE",s="Settings/Review_Workflows/WORKFLOW_CLONE_STAGE",o="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGE",O="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGES",d="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGE_POSITION",L="Settings/Review_Workflows/WORKFLOW_UPDATE",h={primary600:"Blue",primary200:"Lilac",alternative600:"Violet",alternative200:"Lavender",success600:"Green",success200:"Pale Green",danger500:"Cherry",danger200:"Pink",warning600:"Orange",warning200:"Yellow",secondary600:"Teal",secondary200:"Baby Blue",neutral400:"Gray",neutral0:"White"},R=e.W.colors.primary600,C={STAGE:"stage"},S="numberOfWorkflows",D="stagesPerWorkflow"},52258:(A,f,t)=>{t.d(f,{n:()=>v});var e=t(67294),n=t(32638),r=t(88767);function v(w={}){const{get:T}=(0,n.useFetchClient)(),{id:c="",...u}=w,g={populate:"stages"},{data:a,isLoading:s,status:o,refetch:O}=(0,r.useQuery)(["review-workflows","workflows",c],async()=>(await T(`/admin/review-workflows/workflows/${c}`,{params:{...g,...u}})).data),d=e.useMemo(()=>c&&a?.data?[a.data]:Array.isArray(a?.data)?a.data:[],[a?.data,c]);return{meta:e.useMemo(()=>a?.meta??{},[a?.meta]),workflows:d,isLoading:s,status:o,refetch:O}}},26259:(A,f,t)=>{t.r(f),t.d(f,{default:()=>X});var e=t(67294),n=t(32638),r=t(86706),v=t(36364),w=t(96987),T=t(74863),c=t(5923),u=t(38454),g=t(3547),a=t(29299),s=t(69398),o=t(71068),O=t(22304),d=t(35752),L=t(96208),h=t(83598),R=t(2382),C=t(54425),S=t(86896),D=t(88767),P=t(16550),W=t(71997),m=t(92686),E=t(75021),y=t(43390),M=t(38705),p=t(86978),V=t(52258);const Y=(0,W.ZP)(n.Link)`
  align-items: center;
  height: ${(0,n.pxToRem)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:l})=>`${l.spaces[2]}}`};
  width: ${(0,n.pxToRem)(32)};

  svg {
    height: ${(0,n.pxToRem)(12)};
    width: ${(0,n.pxToRem)(12)};

    path {
      fill: ${({theme:l})=>l.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:l})=>l.colors.neutral800};
      }
    }
  }
`;function z(){const{formatMessage:l}=(0,S.Z)(),{push:G}=(0,P.k6)(),{collectionTypes:J,singleTypes:b,isLoading:q}=(0,m.G)(),{meta:x,workflows:Z,isLoading:B,refetch:_}=(0,V.n)(),[U,F]=e.useState(null),[ee,N]=e.useState(!1),{del:te}=(0,n.useFetchClient)(),{formatAPIError:ne}=(0,n.useAPIErrorHandler)(),$=(0,n.useNotification)(),{getFeature:se,isLoading:j}=(0,E.q)(),{trackUsage:H}=(0,n.useTracking)(),ae=(0,r.v9)(v._),{allowedActions:{canCreate:Q,canDelete:oe}}=(0,n.useRBAC)(ae.settings["review-workflows"]),I=se("review-workflows"),{mutateAsync:le,isLoading:re}=(0,D.useMutation)(async({workflowId:i,stages:k})=>{const{data:{data:K}}=await te(`/admin/review-workflows/workflows/${i}`,{data:k});return K},{onSuccess(){$({type:"success",message:{id:"notification.success.deleted",defaultMessage:"Deleted"}})}}),ie=i=>[...J,...b].find(K=>K.uid===i).info.displayName,ce=i=>{F(i)},de=()=>{F(null)},fe=async()=>{try{const i=await le({workflowId:U});return await _(),F(null),i}catch(i){return $({type:"warning",message:ne(i)}),null}};return e.useEffect(()=>{!B&&!j&&I?.[p.Ef]&&x?.workflowCount>parseInt(I[p.Ef],10)&&N(!0)},[j,B,I,x?.workflowCount,x.workflowsTotal]),e.createElement(e.Fragment,null,e.createElement(y.h4,{primaryAction:Q&&e.createElement(n.LinkButton,{startIcon:e.createElement(h.Z,null),size:"S",to:"/settings/review-workflows/create",onClick:i=>{I?.[p.Ef]&&x?.workflowCount>=parseInt(I[p.Ef],10)?(i.preventDefault(),N(!0)):H("willCreateWorkflow")}},l({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})),subtitle:l({id:"Settings.review-workflows.list.page.subtitle",defaultMessage:"Manage your content review process"}),title:l({id:"Settings.review-workflows.list.page.title",defaultMessage:"Review Workflows"})}),e.createElement(y.fC,null,B||q?e.createElement(w.k,{justifyContent:"center"},e.createElement(T.a,null,l({id:"Settings.review-workflows.page.list.isLoading",defaultMessage:"Workflows are loading"}))):e.createElement(c.i,{colCount:3,footer:Q&&e.createElement(u.c,{icon:e.createElement(h.Z,null),onClick:()=>{I?.[p.Ef]&&x?.workflowCount>=parseInt(I[p.Ef],10)?N(!0):(G("/settings/review-workflows/create"),H("willCreateWorkflow"))}},l({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})),rowCount:1},e.createElement(g.h,null,e.createElement(a.Tr,null,e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},l({id:"Settings.review-workflows.list.page.list.column.name.title",defaultMessage:"Name"}))),e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},l({id:"Settings.review-workflows.list.page.list.column.stages.title",defaultMessage:"Stages"}))),e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},l({id:"Settings.review-workflows.list.page.list.column.contentTypes.title",defaultMessage:"Content Types"}))),e.createElement(s.Th,null,e.createElement(O.T,null,l({id:"Settings.review-workflows.list.page.list.column.actions.title",defaultMessage:"Actions"}))))),e.createElement(d.p,null,Z.map(i=>e.createElement(a.Tr,{...(0,n.onRowClick)({fn(k){k.target.nodeName!=="BUTTON"&&G(`/settings/review-workflows/${i.id}`)}}),key:`workflow-${i.id}`},e.createElement(s.Td,{width:(0,n.pxToRem)(250)},e.createElement(o.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0},i.name)),e.createElement(s.Td,null,e.createElement(o.Z,{textColor:"neutral800"},i.stages.length)),e.createElement(s.Td,null,e.createElement(o.Z,{textColor:"neutral800"},(i?.contentTypes??[]).map(ie).join(", "))),e.createElement(s.Td,null,e.createElement(w.k,{alignItems:"center",justifyContent:"end"},e.createElement(Y,{to:`/settings/review-workflows/${i.id}`,"aria-label":l({id:"Settings.review-workflows.list.page.list.column.actions.edit.label",defaultMessage:"Edit {name}"},{name:i.name})},e.createElement(R.Z,null)),Z.length>1&&oe&&e.createElement(L.h,{"aria-label":l({id:"Settings.review-workflows.list.page.list.column.actions.delete.label",defaultMessage:"Delete {name}"},{name:"Default workflow"}),icon:e.createElement(C.Z,null),noBorder:!0,onClick:()=>{ce(i.id)}}))))))),e.createElement(n.ConfirmDialog,{bodyText:{id:"Settings.review-workflows.list.page.delete.confirm.body",defaultMessage:"If you remove this worfklow, all stage-related information will be removed for this content-type. Are you sure you want to remove it?"},isConfirmButtonLoading:re,isOpen:!!U,onToggleDialog:de,onConfirm:fe}),e.createElement(M.fC,{isOpen:ee,onClose:()=>N(!1)},e.createElement(M.Dx,null,l({id:"Settings.review-workflows.list.page.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})),e.createElement(M.uT,null,l({id:"Settings.review-workflows.list.page.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})))))}function X(){const l=(0,r.v9)(v._);return e.createElement(n.CheckPagePermissions,{permissions:l.settings["review-workflows"].main},e.createElement(z,null))}},97695:(A,f,t)=>{t.d(f,{Z:()=>r});var e=t(85893);const n=v=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...v,children:(0,e.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),r=n}}]);
