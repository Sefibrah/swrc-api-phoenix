"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[7744],{57744:(u,c,s)=>{s.d(c,{ProtectedListView:()=>rs});var t=s(92132),l=s(21272),U=s(38413),I=s(55356),d=s(25815),D=s(4198),_=s(65536),E=s(5194),a=s(96854),T=s(54894),e=s(46725),W=s(56740),K=s(79582),L=s(99831),B=s(22185),x=s(15126),F=s(63299),V=s(67014),Y=s(59080),z=s(79275),G=s(14718),p=s(82437),Q=s(61535),H=s(5790),J=s(12083),Z=s(35223),n=s(74930),r=s(2600),P=s(48940),O=s(41286),m=s(56336),M=s(13426),i=s(84624),v=s(77965),A=s(54257),y=s(71210),X=s(51187),w=s(39404),b=s(58692),q=s(501),ss=s(57646),o=s(23120),ts=s(44414),S=s(25962),Os=s(14664),ms=s(42588),As=s(90325),cs=s(62785),fs=s(87443),gs=s(41032),Cs=s(22957),Ls=s(93179),vs=s(73055),Rs=s(15747),hs=s(85306),Us=s(26509),Is=s(32058),Ws=s(81185),Bs=s(82261);const os=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],_s=()=>{(0,_.useFocusWhenNavigate)();const{formatMessage:f}=(0,T.A)(),R=(0,_.useNotification)(),ds=(0,W.j)(C=>C.admin_app.permissions.settings?.["transfer-tokens"]),{isLoading:Es,allowedActions:{canCreate:k,canDelete:is,canUpdate:ls,canRead:h}}=(0,_.useRBAC)(ds),{push:as}=(0,e.W6)(),{trackUsage:j}=(0,_.useTracking)(),{_unstableFormatAPIError:N}=(0,_.useAPIErrorHandler)();l.useEffect(()=>{as({search:a.stringify({sort:"name:ASC"},{encode:!1})})},[as]),(0,W.b)(()=>{j("willAccessTokenList",{tokenType:L.T})});const Ts=os.map(C=>({...C,metadatas:{...C.metadatas,label:f(C.metadatas.label)}})),{data:g=[],isLoading:Ms,error:$}=(0,K.c)(void 0,{skip:!h});l.useEffect(()=>{g&&j("didAccessTokenList",{number:g.length,tokenType:L.T})},[j,g]),l.useEffect(()=>{$&&R({type:"warning",message:N($)})},[$,N,R]);const[Ds]=(0,K.d)(),Ps=async C=>{try{const ns=await Ds(C);"error"in ns&&R({type:"warning",message:N(ns.error)})}catch{R({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}},es=Ms||Es;return(0,t.jsxs)(U.g,{"aria-busy":es,children:[(0,t.jsx)(_.SettingsPageTitle,{name:"Transfer Tokens"}),(0,t.jsx)(I.Q,{title:f({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:f({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:k?(0,t.jsx)(d.z,{"data-testid":"create-transfer-token-button",startIcon:(0,t.jsx)(E.A,{}),size:"S",onClick:()=>j("willAddTokenFromList",{tokenType:L.T}),to:"/settings/transfer-tokens/create",children:f({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})}):void 0}),(0,t.jsxs)(D.s,{children:[!h&&(0,t.jsx)(_.NoPermissions,{}),h&&g.length>0&&(0,t.jsx)(B.T,{permissions:{canRead:h,canDelete:is,canUpdate:ls},headers:Ts,contentType:"trasfer-tokens",isLoading:es,onConfirmDelete:Ps,tokens:g,tokenType:L.T}),h&&k&&g.length===0&&(0,t.jsx)(_.NoContent,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:(0,t.jsx)(d.z,{variant:"secondary",startIcon:(0,t.jsx)(E.A,{}),to:"/settings/transfer-tokens/create",children:f({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"})})}),h&&!k&&g.length===0&&(0,t.jsx)(_.NoContent,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})]})]})},rs=()=>{const f=(0,W.j)(R=>R.admin_app.permissions.settings?.["transfer-tokens"].main);return(0,t.jsx)(_.CheckPagePermissions,{permissions:f,children:(0,t.jsx)(_s,{})})}},22185:(u,c,s)=>{s.d(c,{T:()=>Y});var t=s(92132),l=s(21272),U=s(25641),I=s(90361),d=s(33363),D=s(85829),_=s(83997),E=s(94061),a=s(88353),T=s(21610),e=s(65536),W=s(50612),K=s(83925),L=s(41909),B=s(54894),x=s(46725),F=s(28183),V=s(42638);const Y=({permissions:n,headers:r=[],contentType:P,isLoading:O=!1,tokens:m=[],onConfirmDelete:M,tokenType:i})=>{const{canDelete:v,canUpdate:A,canRead:y}=n;return(0,t.jsx)(e.DynamicTable,{headers:r,contentType:P,rows:m,withBulkActions:v||A||y,isLoading:O,onConfirmDelete:M,children:(0,t.jsx)(z,{tokenType:i,permissions:n,onConfirmDelete:M})})},z=({tokenType:n,permissions:r,rows:P=[],withBulkActions:O,onConfirmDelete:m})=>{const{canDelete:M,canUpdate:i,canRead:v}=r,[{query:A}]=(0,e.useQueryParams)(),{formatMessage:y}=(0,B.A)(),[,X]=A&&A.sort?A.sort.split(":"):[void 0,"ASC"],{push:w,location:{pathname:b}}=(0,x.W6)(),{trackUsage:q}=(0,e.useTracking)(),ss=[...P].sort((o,ts)=>{const S=o.name.localeCompare(ts.name);return X==="DESC"?-S:S});return(0,t.jsx)(U.N,{children:ss.map(o=>(0,t.jsxs)(I.Tr,{...(0,e.onRowClick)({fn(){q("willEditTokenFromList",{tokenType:n}),w(`${b}/${o.id}`)},condition:i}),children:[(0,t.jsx)(d.Td,{maxWidth:(0,e.pxToRem)(250),children:(0,t.jsx)(D.o,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:o.name})}),(0,t.jsx)(d.Td,{maxWidth:(0,e.pxToRem)(250),children:(0,t.jsx)(D.o,{textColor:"neutral800",ellipsis:!0,children:o.description})}),(0,t.jsx)(d.Td,{children:(0,t.jsx)(D.o,{textColor:"neutral800",children:(0,t.jsx)(e.RelativeTime,{timestamp:new Date(o.createdAt)})})}),(0,t.jsx)(d.Td,{children:o.lastUsedAt&&(0,t.jsx)(D.o,{textColor:"neutral800",children:(0,t.jsx)(e.RelativeTime,{timestamp:new Date(o.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:y({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]})})}),O&&(0,t.jsx)(d.Td,{children:(0,t.jsxs)(_.s,{justifyContent:"end",children:[i&&(0,t.jsx)(Z,{tokenName:o.name,tokenId:o.id}),!i&&v&&(0,t.jsx)(J,{tokenName:o.name,tokenId:o.id}),M&&(0,t.jsx)(H,{tokenName:o.name,onClickDelete:()=>m?.(o.id),tokenType:n})]})})]},o.id))})},G={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},p=({tokenName:n,tokenId:r,buttonType:P="edit",children:O})=>{const{formatMessage:m}=(0,B.A)(),{location:{pathname:M}}=(0,x.W6)();return(0,t.jsx)(Q,{forwardedAs:F.k2,to:`${M}/${r}`,title:m(G[P],{target:n}),children:O})},Q=(0,V.Ay)(T.N)`
  svg {
    path {
      fill: ${({theme:n})=>n.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:n})=>n.colors.neutral800};
      }
    }
  }
`,H=({tokenName:n,onClickDelete:r,tokenType:P})=>{const{formatMessage:O}=(0,B.A)(),{trackUsage:m}=(0,e.useTracking)(),[M,i]=l.useState(!1),v=()=>{i(!1),m("willDeleteToken",{tokenType:P}),r()};return(0,t.jsxs)(E.a,{paddingLeft:1,onClick:A=>A.stopPropagation(),children:[(0,t.jsx)(a.K,{onClick:()=>{i(!0)},label:O({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${n}`}),name:"delete",borderWidth:0,icon:(0,t.jsx)(W.A,{})}),(0,t.jsx)(e.ConfirmDialog,{onToggleDialog:()=>i(!1),onConfirm:v,isOpen:M})]})},J=({tokenName:n,tokenId:r})=>(0,t.jsx)(p,{tokenName:n,tokenId:r,buttonType:"read",children:(0,t.jsx)(K.A,{})}),Z=({tokenName:n,tokenId:r})=>(0,t.jsx)(p,{tokenName:n,tokenId:r,children:(0,t.jsx)(L.A,{width:12})})},99831:(u,c,s)=>{s.d(c,{A:()=>t,T:()=>l});const t="api-token",l="transfer-token"},79582:(u,c,s)=>{s.d(c,{a:()=>d,b:()=>_,c:()=>U,d:()=>D,u:()=>I});var t=s(56740);const l=t.n.injectEndpoints({endpoints:E=>({getTransferTokens:E.query({query:()=>({url:"/admin/transfer/tokens",method:"GET"}),transformResponse:a=>a.data,providesTags:(a,T)=>[...a?.map(({id:e})=>({type:"TransferToken",id:e}))??[],{type:"TransferToken",id:"LIST"}]}),getTransferToken:E.query({query:a=>`/admin/transfer/tokens/${a}`,transformResponse:a=>a.data,providesTags:(a,T,e)=>[{type:"TransferToken",id:e}]}),createTransferToken:E.mutation({query:a=>({url:"/admin/transfer/tokens",method:"POST",data:a}),transformResponse:a=>a.data,invalidatesTags:[{type:"TransferToken",id:"LIST"}]}),deleteTransferToken:E.mutation({query:a=>({url:`/admin/transfer/tokens/${a}`,method:"DELETE"}),transformResponse:a=>a.data,invalidatesTags:(a,T,e)=>[{type:"TransferToken",id:e}]}),updateTransferToken:E.mutation({query:({id:a,...T})=>({url:`/admin/transfer/tokens/${a}`,method:"PUT",data:T}),transformResponse:a=>a.data,invalidatesTags:(a,T,{id:e})=>[{type:"TransferToken",id:e}]})}),overrideExisting:!1}),{useGetTransferTokensQuery:U,useGetTransferTokenQuery:I,useCreateTransferTokenMutation:d,useDeleteTransferTokenMutation:D,useUpdateTransferTokenMutation:_}=l}}]);
