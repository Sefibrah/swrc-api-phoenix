"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[1495],{82781:(b,p,t)=>{t.r(p),t.d(p,{default:()=>Q});var e=t(67294),n=t(97132),o=t(68547),c=t(185),g=t(49066),h=t(7681),T=t(41580),x=t(11276),f=t(74571),A=t(75515),E=t(16364),B=t(29728),y=t(14087),s=t(23293),u=t(45697),l=t.n(u),r=t(71893),m=t(91216),v=t(82562),i=t(47560);const R=r.default.a`
  color: ${({theme:a})=>a.colors.primary600};
`,Z=({config:a})=>{const{formatMessage:d}=(0,n.useIntl)();return e.createElement(h.K,{spacing:4},e.createElement(h.K,{spacing:1},e.createElement(A.Z,{variant:"delta",as:"h2"},d({id:(0,i.Z)("Settings.email.plugin.title.config"),defaultMessage:"Configuration"})),e.createElement(A.Z,null,d({id:(0,i.Z)("Settings.email.plugin.text.configuration"),defaultMessage:"The plugin is configured through the {file} file, checkout this {link} for the documentation."},{file:"./config/plugins.js",link:e.createElement(R,{href:"https://docs.strapi.io/developer-docs/latest/plugins/email.html",target:"_blank",rel:"noopener noreferrer"},d({id:(0,i.Z)("link"),defaultMessage:"Link"}))}))),e.createElement(x.r,{gap:5},e.createElement(f.P,{col:6,s:12},e.createElement(E.o,{name:"shipper-email",label:d({id:(0,i.Z)("Settings.email.plugin.label.defaultFrom"),defaultMessage:"Default sender email"}),placeholder:d({id:(0,i.Z)("Settings.email.plugin.placeholder.defaultFrom"),defaultMessage:"ex: Strapi No-Reply '<'no-reply@strapi.io'>'"}),disabled:!0,onChange:()=>{},value:a.settings.defaultFrom})),e.createElement(f.P,{col:6,s:12},e.createElement(E.o,{name:"response-email",label:d({id:(0,i.Z)("Settings.email.plugin.label.defaultReplyTo"),defaultMessage:"Default response email"}),placeholder:d({id:(0,i.Z)("Settings.email.plugin.placeholder.defaultReplyTo"),defaultMessage:"ex: Strapi '<'example@strapi.io'>'"}),disabled:!0,onChange:()=>{},value:a.settings.defaultReplyTo})),e.createElement(f.P,{col:6,s:12},e.createElement(m.P,{name:"email-provider",label:d({id:(0,i.Z)("Settings.email.plugin.label.provider"),defaultMessage:"Email provider"}),disabled:!0,onChange:()=>{},value:a.provider},e.createElement(v.W,{value:a.provider},a.provider)))))};Z.propTypes={config:l().shape({provider:l().string,settings:l().shape({defaultFrom:l().string,defaultReplyTo:l().string})}).isRequired};const C=Z;var D=t(53209);const O=D.Ry().shape({email:D.Z_().email(o.translatedErrors.email).required(o.translatedErrors.required)});var z=t(61321),V=t(11817);const I=V.Z.create({baseURL:""});I.interceptors.request.use(async a=>(a.headers={Authorization:`Bearer ${o.auth.getToken()}`,Accept:"application/json","Content-Type":"application/json"},a),a=>{Promise.reject(a)}),I.interceptors.response.use(a=>a,a=>{throw a.response?.status===401&&(o.auth.clearAppStorage(),window.location.reload()),a});const F=(0,o.wrapAxiosInstance)(I),$=async()=>{const{data:a}=await F.get("/email/settings");return a.config},G=async a=>{await F.post("/email/test",a)};var k=t(53979);const j=()=>{const{formatMessage:a}=(0,n.useIntl)();return e.createElement(e.Fragment,null,e.createElement(o.SettingsPageTitle,{name:a({id:(0,i.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"})}),e.createElement(k.T,{id:"title",title:a({id:(0,i.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"}),subtitle:a({id:(0,i.Z)("Settings.email.plugin.subTitle"),defaultMessage:"Test the settings for the Email plugin"})}))},Y=()=>e.createElement(o.CheckPagePermissions,{permissions:z.Z.settings},e.createElement(J,null)),J=()=>{const a=(0,o.useNotification)(),{formatMessage:d}=(0,n.useIntl)(),{lockApp:X,unlockApp:q}=(0,o.useOverlayBlocker)(),{notifyStatus:K}=(0,y.G)();(0,o.useFocusWhenNavigate)();const[P,_]=(0,e.useState)({}),[ee,w]=(0,e.useState)(!1),[H,W]=(0,e.useState)(!1),[S,U]=(0,e.useState)(""),[te,N]=(0,e.useState)(!1),[ae,ne]=(0,e.useState)({provider:"",settings:{defaultFrom:"",defaultReplyTo:"",testAddress:""}});(0,e.useEffect)(()=>{w(!0),$().then(M=>{K(d({id:(0,i.Z)("Settings.email.plugin.notification.data.loaded"),defaultMessage:"Email settings data has been loaded"})),ne(M);const L=M?.settings?.testAddress;L&&U(L)}).catch(()=>a({type:"warning",message:d({id:(0,i.Z)("Settings.email.plugin.notification.config.error"),defaultMessage:"Failed to retrieve the email config"})})).finally(()=>w(!1))},[d,a,K]),(0,e.useEffect)(()=>{P.email&&document.querySelector("#test-address-input").focus()},[P]),(0,e.useEffect)(()=>{O.validate({email:S},{abortEarly:!1}).then(()=>N(!0)).catch(()=>N(!1))},[S]);const se=M=>{U(()=>M.target.value)},ie=async M=>{M.preventDefault();try{await O.validate({email:S},{abortEarly:!1}),W(!0),X(),G({to:S}).then(()=>{a({type:"success",message:d({id:(0,i.Z)("Settings.email.plugin.notification.test.success"),defaultMessage:"Email test succeeded, check the {to} mailbox"},{to:S})})}).catch(()=>{a({type:"warning",message:d({id:(0,i.Z)("Settings.email.plugin.notification.test.error"),defaultMessage:"Failed to send a test mail to {to}"},{to:S})})}).finally(()=>{W(!1),q()})}catch(L){_((0,o.getYupInnerErrors)(L))}};return ee?e.createElement(c.o,{labelledBy:"title","aria-busy":"true"},e.createElement(j,null),e.createElement(g.D,null,e.createElement(o.LoadingIndicatorPage,null))):e.createElement(c.o,{labelledBy:"title","aria-busy":H},e.createElement(j,null),e.createElement(g.D,null,e.createElement("form",{onSubmit:ie},e.createElement(h.K,{spacing:7},e.createElement(T.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(C,{config:ae})),e.createElement(T.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(h.K,{spacing:4},e.createElement(A.Z,{variant:"delta",as:"h2"},d({id:(0,i.Z)("Settings.email.plugin.title.test"),defaultMessage:"Test email delivery"})),e.createElement(x.r,{gap:5,alignItems:"end"},e.createElement(f.P,{col:6,s:12},e.createElement(E.o,{id:"test-address-input",name:"test-address",onChange:se,label:d({id:(0,i.Z)("Settings.email.plugin.label.testAddress"),defaultMessage:"Recipient email"}),value:S,error:P.email?.id&&d({id:(0,i.Z)(`${P.email?.id}`),defaultMessage:"This is an invalid email"}),placeholder:d({id:(0,i.Z)("Settings.email.plugin.placeholder.testAddress"),defaultMessage:"ex: developer@example.com"})})),e.createElement(f.P,{col:7,s:12},e.createElement(B.z,{loading:H,disabled:!te,type:"submit",startIcon:e.createElement(s.Z,null)},d({id:(0,i.Z)("Settings.email.plugin.button.test-email"),defaultMessage:"Send test email"}))))))))))},Q=Y},49066:(b,p,t)=>{t.d(p,{D:()=>c});var e=t(67294),n=t(45697),o=t(41580);const c=({children:g})=>e.createElement(o.x,{paddingLeft:10,paddingRight:10},g);c.propTypes={children:n.node.isRequired}},53979:(b,p,t)=>{t.d(p,{T:()=>E});var e=t(67294),n=t(45697),o=t(71893),c=t(41580),g=t(11047);const h=s=>{const u=(0,e.useRef)(null),[l,r]=(0,e.useState)(!0),m=([v])=>{r(v.isIntersecting)};return(0,e.useEffect)(()=>{const v=u.current,i=new IntersectionObserver(m,s);return v&&i.observe(u.current),()=>{v&&i.disconnect()}},[u,s]),[u,l]};var T=t(98402);const x=(s,u)=>{const l=(0,T.useCallbackRef)(u);(0,e.useLayoutEffect)(()=>{const r=new ResizeObserver(l);return Array.isArray(s)?s.forEach(m=>{m.current&&r.observe(m.current)}):s.current&&r.observe(s.current),()=>{r.disconnect()}},[s,l])};var f=t(75515);const A=()=>{const s=(0,e.useRef)(null),[u,l]=(0,e.useState)(null),[r,m]=h({root:null,rootMargin:"0px",threshold:0});return x(r,()=>{r.current&&l(r.current.getBoundingClientRect())}),(0,e.useEffect)(()=>{s.current&&l(s.current.getBoundingClientRect())},[s]),{containerRef:r,isVisible:m,baseHeaderLayoutRef:s,headerSize:u}},E=s=>{const{containerRef:u,isVisible:l,baseHeaderLayoutRef:r,headerSize:m}=A();return e.createElement(e.Fragment,null,e.createElement("div",{style:{height:m?.height},ref:u},l&&e.createElement(y,{ref:r,...s})),!l&&e.createElement(y,{...s,sticky:!0,width:m?.width}))};E.displayName="HeaderLayout";const B=(0,o.default)(c.x)`
  width: ${s=>s.width}px;
`,y=e.forwardRef(({navigationAction:s,primaryAction:u,secondaryAction:l,subtitle:r,title:m,sticky:v,width:i,...R},Z)=>{const C=typeof r=="string";return v?e.createElement(B,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:i,zIndex:4,"data-strapi-header-sticky":!0},e.createElement(g.k,{justifyContent:"space-between"},e.createElement(g.k,null,s&&e.createElement(c.x,{paddingRight:3},s),e.createElement(c.x,null,e.createElement(f.Z,{variant:"beta",as:"h1",...R},m),C?e.createElement(f.Z,{variant:"pi",textColor:"neutral600"},r):r),l?e.createElement(c.x,{paddingLeft:4},l):null),e.createElement(g.k,null,u?e.createElement(c.x,{paddingLeft:2},u):void 0))):e.createElement(c.x,{ref:Z,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:s?6:8,background:"neutral100","data-strapi-header":!0},s?e.createElement(c.x,{paddingBottom:2},s):null,e.createElement(g.k,{justifyContent:"space-between"},e.createElement(g.k,{minWidth:0},e.createElement(f.Z,{as:"h1",variant:"alpha",...R},m),l?e.createElement(c.x,{paddingLeft:4},l):null),u),C?e.createElement(f.Z,{variant:"epsilon",textColor:"neutral600",as:"p"},r):r)});y.displayName="BaseHeaderLayout",y.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0,sticky:!1,width:void 0},y.propTypes={navigationAction:n.node,primaryAction:n.node,secondaryAction:n.node,sticky:n.bool,subtitle:n.oneOfType([n.string,n.node]),title:n.string.isRequired,width:n.number},E.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0},E.propTypes={navigationAction:n.node,primaryAction:n.node,secondaryAction:n.node,subtitle:n.oneOfType([n.string,n.node]),title:n.string.isRequired}},185:(b,p,t)=>{t.d(p,{o:()=>g});var e=t(67294),n=t(45697),o=t(71893);const c=o.default.main`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,g=({labelledBy:h,...T})=>{const x=h||"main-content-title";return e.createElement(c,{"aria-labelledby":x,id:"main-content",tabIndex:-1,...T})};g.defaultProps={labelledBy:void 0},g.propTypes={labelledBy:n.string}},23293:(b,p,t)=>{t.d(p,{Z:()=>o});var e=t(85893);const n=c=>(0,e.jsxs)("svg",{width:"1rem",height:"1rem",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...c,children:[(0,e.jsx)("path",{d:"M0 2.8A.8.8 0 0 1 .8 2h22.4a.8.8 0 0 1 .8.8v2.71a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V2.8Z",fill:"#32324D"}),(0,e.jsx)("path",{d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873ZM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053Z",fill:"#32324D"}),(0,e.jsx)("path",{d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555Z",fill:"#32324D"})]}),o=n}}]);
