"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[5895],{58659:(ee,L,t)=>{t.r(L),t.d(L,{SettingsPage:()=>Dt,default:()=>Kt});var e=t(67294),y=t(27298),s=t(49656),l=t(72899),c=t(49212),M=t(73117),Ce=t(48474),se=t(38683),W=t(15861),z=t(64687),v=t.n(z),pe=t(68960),te=t(22522),ge=t(87751),ie=t(45697),E=t.n(ie);const F=750,Z=100,re=["image/jpeg","image/png","image/svg+xml"];var ne=t(18172);const Fe={localImage:void 0},x=(C=Fe,m)=>(0,ne.default)(C,g=>{switch(m.type){case"SET_LOCAL_IMAGE":{g.localImage=m.value;break}default:return g}}),le=({onChangeLogo:C,customLogo:m,goTo:g,Component:A,modalTitle:u,next:oe,prev:U,currentStep:X})=>{const[{localImage:N},j]=(0,e.useReducer)(x,Fe),{formatMessage:Ae}=(0,c.useIntl)(),ce=Ie=>{j({type:"SET_LOCAL_IMAGE",value:Ie})},we=()=>{g(null)};return X?e.createElement(l.ModalLayout,{labelledBy:"modal",onClose:we},e.createElement(l.ModalHeader,null,e.createElement(l.Typography,{fontWeight:"bold",as:"h2",id:"modal"},Ae(u))),e.createElement(A,{setLocalImage:ce,goTo:g,next:oe,prev:U,onClose:we,asset:N||m,onChangeLogo:C})):null};le.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},le.propTypes={Component:E().elementType,currentStep:E().string,customLogo:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}),goTo:E().func.isRequired,modalTitle:E().shape({id:E().string,defaultMessage:E().string}),next:E().string,onChangeLogo:E().func.isRequired,prev:E().string};const H=le,f={currentStep:void 0},Q=(C=f,m)=>(0,ne.default)(C,g=>{switch(m.type){case"GO_TO":{g.currentStep=m.to;break}default:return g}});var Se=t(71893);const P={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},w={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},Y=C=>new Promise(m=>{const g=new FileReader;g.onload=()=>{const A=new Image;A.onload=function(){m({width:A.width,height:A.height})},A.src=g.result},g.readAsDataURL(C)}),q=(C,m)=>({ext:C.name.split(".").pop(),size:C.size/1e3,name:C.name,url:URL.createObjectURL(C),rawFile:C,width:m.width,height:m.height}),ye=async C=>{let m;if(!re.includes(C.type))throw m=new Error("File format"),m.displayMessage=P,m;const A=await Y(C);if(!(A.width<=F&&A.height<=F))throw m=new Error("File sizing"),m.displayMessage=w,m;const oe=q(C,A);if(!(oe.size<=Z))throw m=new Error("File sizing"),m.displayMessage=w,m;return oe},b=(0,Se.default)(l.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,de=({setLocalImage:C,goTo:m,next:g,onClose:A})=>{const{formatMessage:u}=(0,c.useIntl)(),[oe,U]=(0,e.useState)(!1),[X,N]=(0,e.useState)(void 0),j=(0,e.useRef)(null),Ae=()=>U(!0),ce=()=>U(!1),we=Ge=>{Ge.preventDefault(),j.current.click()},Ie=async()=>{ce();const Ge=j.current.files[0];if(Ge)try{const ze=await ye(Ge);C(ze),m(g)}catch(ze){if(ze.displayMessage)N(u(ze.displayMessage,{size:Z,dimension:F})),j.current.focus();else throw ze}},Ze=()=>oe?"primary500":X?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(l.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(l.Field,{name:"logo-upload",error:X},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(l.Stack,{spacing:2},e.createElement(l.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:oe?"primary100":"neutral100",borderColor:Ze(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:Ae,onDragLeave:ce},e.createElement(l.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:te.PicturePlus,"aria-hidden":!0}),e.createElement(l.Box,{paddingTop:3,paddingBottom:5},e.createElement(l.Typography,{variant:"delta",as:"span"},u({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(b,{accept:re,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Ie,ref:j,id:"logo-upload"}),e.createElement(l.Button,{type:"button",onClick:we},u({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(l.Box,{paddingTop:6},e.createElement(l.Typography,{variant:"pi",textColor:"neutral600"},u({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:Z,dimension:F})))),e.createElement(l.FieldError,null)))))),e.createElement(l.ModalFooter,{startActions:e.createElement(l.Button,{onClick:A,variant:"tertiary"},u({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};de.defaultProps={next:null},de.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const Be=de;var ke=t(48456);const Me=async C=>{try{const m=await ke.Z.get(C,{responseType:"blob",timeout:8e3});return new File([m.data],m.config.url,{type:m.headers["content-type"]})}catch(m){throw m.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},m}},K=({goTo:C,next:m,onClose:g,setLocalImage:A})=>{const{formatMessage:u}=(0,c.useIntl)(),[oe,U]=(0,e.useState)(""),[X,N]=(0,e.useState)(null),j=ce=>{U(ce.target.value)},Ae=async()=>{try{const ce=await Me(oe),we=await ye(ce);A(we),C(m)}catch(ce){if(ce.displayMessage)N(u(ce.displayMessage,{size:Z,dimension:F}));else throw ce}};return e.createElement("form",{onSubmit:ce=>{ce.preventDefault(),Ae()}},e.createElement(l.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(l.TextInput,{label:u({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:X,onChange:j,value:oe,name:"logo-url"})),e.createElement(l.ModalFooter,{startActions:e.createElement(l.Button,{onClick:g,variant:"tertiary"},u({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(l.Button,{type:"submit"},u({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};K.defaultProps={next:null},K.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const me=K,Ue=({setLocalImage:C,goTo:m,next:g,onClose:A})=>{const{formatMessage:u}=(0,c.useIntl)();return e.createElement(l.TabGroup,{label:u({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(l.Box,{paddingLeft:8,paddingRight:8},e.createElement(l.Tabs,null,e.createElement(l.Tab,null,u({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(l.Tab,null,u({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(l.Divider,null)),e.createElement(l.TabPanels,null,e.createElement(l.TabPanel,null,e.createElement(Be,{onClose:A,setLocalImage:C,goTo:m,next:g})),e.createElement(l.TabPanel,null,e.createElement(me,{onClose:A,setLocalImage:C,goTo:m,next:g}))))};Ue.defaultProps={next:null},Ue.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const We=Ue,lt=({asset:C})=>{const{formatMessage:m}=(0,c.useIntl)();return e.createElement(l.Card,null,e.createElement(l.CardHeader,null,e.createElement(l.CardAsset,{size:"S",src:C.url})),e.createElement(l.CardBody,null,e.createElement(l.CardContent,null,e.createElement(l.CardTitle,null,C.name),e.createElement(l.CardSubtitle,null,`${C.ext.toUpperCase()} - ${C.width}\u2715${C.height}`)),e.createElement(l.CardBadge,null,m({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};lt.propTypes={asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired};const _=lt,Te=({onClose:C,asset:m,prev:g,next:A,goTo:u,setLocalImage:oe,onChangeLogo:U})=>{const{formatMessage:X}=(0,c.useIntl)(),N=()=>{oe(void 0),u(g)},j=()=>{U(m),u(A)};return e.createElement(e.Fragment,null,e.createElement(l.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(l.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(l.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(l.Typography,{variant:"pi",fontWeight:"bold"},X({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(l.Typography,{variant:"pi",textColor:"neutral500"},X({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(l.Button,{onClick:N,variant:"secondary"},X({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(l.Box,{maxWidth:(0,y.pxToRem)(180)},e.createElement(_,{asset:m}))),e.createElement(l.ModalFooter,{startActions:e.createElement(l.Button,{onClick:C,variant:"tertiary"},X({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(l.Button,{onClick:j},X({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Te.defaultProps={next:null,prev:null},Te.propTypes={goTo:E().func.isRequired,asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired,next:E().string,onClose:E().func.isRequired,onChangeLogo:E().func.isRequired,prev:E().string,setLocalImage:E().func.isRequired};const Et={upload:{Component:We,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Te,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},at=({canUpdate:C,customLogo:m,defaultLogo:g,hint:A,label:u,onChangeLogo:oe,onResetLogo:U})=>{const[{currentStep:X},N]=(0,e.useReducer)(Q,f),{Component:j,next:Ae,prev:ce,modalTitle:we}=Et[X]||{},{formatMessage:Ie}=(0,c.useIntl)(),Ze=Ge=>{N({type:"GO_TO",to:Ge})};return e.createElement(e.Fragment,null,e.createElement(l.CarouselInput,{label:u,selectedSlide:0,hint:A,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:m?.name||"logo.png",actions:e.createElement(l.CarouselActions,null,e.createElement(l.IconButton,{disabled:!C,onClick:()=>Ze(m?"pending":"upload"),label:Ie({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(te.Plus,null)}),m&&e.createElement(l.IconButton,{disabled:!C,onClick:U,label:Ie({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(te.Refresh,null)}))},e.createElement(l.CarouselSlide,{label:Ie({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(l.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:m?.url||g,alt:Ie({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(H,{Component:j,currentStep:X,onChangeLogo:oe,customLogo:m,goTo:Ze,next:Ae,prev:ce,modalTitle:we}))};at.defaultProps={canUpdate:!1,customLogo:null,hint:null},at.propTypes={canUpdate:E().bool,customLogo:E().shape({url:E().string,name:E().string}),label:E().string.isRequired,hint:E().string,defaultLogo:E().string.isRequired,onChangeLogo:E().func.isRequired,onResetLogo:E().func.isRequired};const Ve=at,vt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},sn=(C=vt,m)=>(0,ne.default)(C,g=>{switch(m.type){case"SET_CUSTOM_MENU_LOGO":{g.menuLogo.display=m.value,g.menuLogo.submit.rawFile=m.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{g.authLogo.display=m.value,g.authLogo.submit.rawFile=m.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{g.menuLogo.display=null,g.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{g.authLogo.display=null,g.authLogo.submit={rawFile:null,isReset:!0};break}default:return g}});var He=t(82492),rn=t.n(He);const cn=(C,m)=>rn()(C,{menuLogo:{display:m.menuLogo},authLogo:{display:m.authLogo}}),Ke=(0,e.forwardRef)(({canUpdate:C,projectSettingsStored:m},g)=>{const{formatMessage:A}=(0,c.useIntl)(),{trackUsage:u}=(0,y.useTracking)(),{logos:{menu:oe,auth:U}}=(0,Ce.um)(),[{menuLogo:X,authLogo:N},j]=(0,e.useReducer)(sn,vt,()=>cn(vt,m)),Ae=Ze=>{j({type:"SET_CUSTOM_MENU_LOGO",value:Ze})},ce=()=>{u("didClickResetLogo",{logo:"menu"}),j({type:"RESET_CUSTOM_MENU_LOGO"})},we=Ze=>{j({type:"SET_CUSTOM_AUTH_LOGO",value:Ze})},Ie=()=>{u("didClickResetLogo",{logo:"auth"}),j({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(g,()=>({getValues:()=>({menuLogo:X.submit,authLogo:N.submit})})),e.createElement(l.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(l.Typography,{variant:"delta",as:"h3"},A({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(l.Typography,{variant:"pi",textColor:"neutral600"},A({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:F,size:Z})),e.createElement(l.Grid,{paddingTop:4,gap:4},e.createElement(l.GridItem,{col:6,s:12},e.createElement(Ve,{canUpdate:C,customLogo:X.display,defaultLogo:oe.default,hint:A({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:A({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:Ae,onResetLogo:ce})),e.createElement(l.GridItem,{col:6,s:12},e.createElement(Ve,{canUpdate:C,customLogo:N.display,defaultLogo:U.default,hint:A({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:A({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:we,onResetLogo:Ie}))))});Ke.defaultProps={canUpdate:!1,projectSettingsStored:null},Ke.propTypes={canUpdate:E().bool,projectSettingsStored:E().shape({menuLogo:E().shape({url:E().string,name:E().string})})};const dn=Ke;var _e=t(68718),St=t.n(_e);const dt=C=>St()(C,(m,g,A)=>{g&&g.url?m[A]={...g,url:(0,y.prefixFileUrlWithBackendUrl)(g.url)}:m[A]=g},{}),Ot=async()=>{const{get:C}=(0,y.getFetchClient)(),{data:m}=await C("/admin/project-settings");return dt(m)},Tt=async C=>{const{post:m}=(0,y.getFetchClient)(),{data:g}=await m("/admin/project-settings",C,{headers:{"Content-Type":"multipart/form-data"}});return dt(g)},At=C=>{const m=new FormData;return Object.entries(C).forEach(([g,A])=>{A&&A.rawFile instanceof File&&m.append(g,A.rawFile),A&&A.isReset&&m.append(g,null)}),m};var Bt=function(){return window&&window.strapi&&window.strapi.isEE?t(78413).Z:t(69767).Z}(),Rt=function(){var m=(0,e.useRef)(),g=(0,y.useNotification)(),A=(0,y.useTracking)(),u=A.trackUsage,oe=(0,c.useIntl)(),U=oe.formatMessage,X=(0,pe.useQueryClient)();(0,y.useFocusWhenNavigate)();var N=(0,y.useAppInfos)(),j=N.latestStrapiReleaseTag,Ae=N.shouldUpdateStrapi,ce=N.strapiVersion,we=(0,Ce.um)(),Ie=we.updateProjectSettings,Ze=(0,y.useRBAC)(ge.Z.settings["project-settings"]),Ge=Ze.allowedActions,ze=Ge.canRead,pt=Ge.canUpdate,gt=ze&&pt,Xt=(0,pe.useQuery)("project-settings",Ot,{enabled:ze}),Qt=Xt.data,Yt=(0,pe.useMutation)(function(ht){return Tt(ht)},{onSuccess:function(ft){return(0,W.Z)(v().mark(function tt(){var Qe,Ye;return v().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return Qe=ft.menuLogo,Ye=ft.authLogo,Je.next=3,X.invalidateQueries("project-settings",{refetchActive:!0});case 3:Ie({menuLogo:Qe?.url,authLogo:Ye?.url});case 4:case"end":return Je.stop()}},tt)}))()}}),Jt=function(ft){if(ft.preventDefault(),!!pt){var tt=m.current.getValues(),Qe=At(tt);Yt.mutate(Qe,{onSuccess:function(){var st=tt.menuLogo,Je=tt.authLogo;st.rawFile&&u("didChangeLogo",{logo:"menu"}),Je.rawFile&&u("didChangeLogo",{logo:"auth"}),g({type:"success",message:U({id:"app",defaultMessage:"Saved"})})},onError:function(){g({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})}};return e.createElement(l.Layout,null,e.createElement(y.SettingsPageTitle,{name:"Application"}),e.createElement(l.Main,null,e.createElement("form",{onSubmit:Jt},e.createElement(l.HeaderLayout,{title:U({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:U({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:gt&&e.createElement(l.Button,{type:"submit",startIcon:e.createElement(te.Check,null)},U({id:"global.save",defaultMessage:"Save"}))}),e.createElement(l.ContentLayout,null,e.createElement(l.Stack,{spacing:6},e.createElement(l.Stack,{spacing:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(l.Typography,{variant:"delta",as:"h3"},U({id:"global.details",defaultMessage:"Details"})),e.createElement(l.Grid,{gap:5,as:"dl"},e.createElement(l.GridItem,{col:6,s:12},e.createElement(l.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},U({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(l.Flex,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(l.Typography,null,"v",ce),Ae&&e.createElement(l.Link,{href:"https://github.com/strapi/strapi/releases/tag/".concat(j),isExternal:!0,endIcon:e.createElement(te.ExternalLink,null)},U({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"})))),e.createElement(l.GridItem,{col:6,s:12},e.createElement(l.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},U({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(l.Flex,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(l.Typography,null,U({id:"Settings.application.ee-or-ce",defaultMessage:"{communityEdition, select, true {Community Edition} other {Enterprise Edition}}"},{communityEdition:N.communityEdition})),e.createElement(l.Link,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(te.ExternalLink,null)},U({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(l.GridItem,{col:6,s:12},e.createElement(l.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},U({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(l.Typography,{as:"dd"},N.nodeVersion)),e.createElement(Bt,null))),ze&&Qt&&e.createElement(dn,{canUpdate:pt,ref:m,projectSettingsStored:Qt}))))))};const kt=Rt;var un=t(94654),wt=t.n(un);const Nt=C=>wt()(C,g=>g.links).map(g=>(0,se.ot)(g.Component,g.to,g.exact||!1)),Ut=C=>C.filter(m=>!m.links.every(g=>g.isDisplayed===!1));var et=t(42982),Lt=function(){return window&&window.strapi&&window.strapi.isEE?t(26789).Z:t(73871).Z}(),mn=function(){return window&&window.strapi&&window.strapi.isEE?t(64527).Z:t(85302).Z}(),Mt=[{Component:function(){return{default:mn}},to:"/settings/roles",exact:!0},{Component:function(){return{default:Lt}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:Lt}},to:"/settings/roles/new",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(2544).then(t.bind(t,92100));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/roles/:id",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5199).then(t.bind(t,37735));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/users",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4263).then(t.bind(t,22282));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/users/:id",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,3672));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/webhooks/create",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,9311));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4121).then(t.bind(t,6784));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/webhooks",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(8056).then(t.bind(t,87427));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/api-tokens",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(4583),t.e(4299)]).then(t.bind(t,9683));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(4583),t.e(92)]).then(t.bind(t,28465));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/api-tokens/:id",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(3219),t.e(4816)]).then(t.bind(t,39987));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/transfer-tokens/create",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(9600).then(t.bind(t,70798));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/transfer-tokens",exact:!0},{Component:function(){return(0,W.Z)(v().mark(function m(){var g;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(7314),t.e(3219),t.e(2492)]).then(t.bind(t,9452));case 2:return g=u.sent,u.abrupt("return",g);case 4:case"end":return u.stop()}},m)}))()},to:"/settings/transfer-tokens/:id",exact:!0}];const pn=Mt;var Wt=function(){return window&&window.strapi&&window.strapi.isEE?t(5420).Z:t(35301).Z}();const Zt=[].concat((0,et.Z)(Wt),(0,et.Z)(pn));var zt=t(92978),Gt=t(75143),ut=t(34446),Vt=t(29489),xt=t(73400);const mt=({menu:C})=>{const{formatMessage:m}=(0,c.useIntl)(),{trackUsage:g}=(0,y.useTracking)(),{pathname:A}=(0,s.useLocation)(),oe=Ut(C).map(N=>({...N,title:N.intlLabel,links:N.links.map(j=>({...j,title:j.intlLabel,name:j.id}))})),U=m({id:"global.settings",defaultMessage:"Settings"}),X=(N=null)=>{g("willNavigate",{from:A,to:N})};return e.createElement(zt.m,{ariaLabel:U},e.createElement(Gt.p,{label:U}),e.createElement(ut.Z,null,oe.map(N=>e.createElement(Vt.D,{key:N.id,label:m(N.intlLabel)},N.links.map(j=>e.createElement(xt.E,{as:s.NavLink,withBullet:j.hasNotification,to:j.to,onClick:()=>X(j.to),key:j.id},m(j.intlLabel)))))))};mt.propTypes={menu:E().array.isRequired};const Ht=mt;function Dt(){const{settingId:C}=(0,s.useParams)(),{settings:m}=(0,y.useStrapiApp)(),{formatMessage:g}=(0,c.useIntl)(),{isLoading:A,menu:u}=(0,Ce.Te)(),oe=(0,e.useMemo)(()=>(0,se.WW)(Zt.map(({to:N,Component:j,exact:Ae})=>(0,se.ot)(j,N,Ae))),[]),U=Nt(m);if(A)return e.createElement(y.LoadingIndicatorPage,null);if(!C)return e.createElement(s.Redirect,{to:"/settings/application-infos"});const X=g({id:"global.settings",defaultMessage:"Settings"});return e.createElement(l.Layout,{sideNav:e.createElement(Ht,{menu:u})},e.createElement(M.Helmet,{title:X}),e.createElement(s.Switch,null,e.createElement(s.Route,{path:"/settings/application-infos",component:kt,exact:!0}),oe,U))}const Kt=(0,e.memo)(Dt)},69767:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=()=>null},73871:(ee,L,t)=>{t.d(L,{Z:()=>l});var e=t(67294),y=t(49656);const l=()=>e.createElement(y.Redirect,{to:"/404"})},79578:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!0},56195:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!0},35820:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!0},28472:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!0},99047:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!0},28834:(ee,L,t)=>{t.d(L,{Z:()=>to});var e=t(67294),y=t(45697),s=t.n(y),l=t(27298),c=t(72899),M=t(18721),Ce=t.n(M),se=t(41609),W=t.n(se),z=t(49212),v=t(71893),pe=t(89734),te=t.n(pe),ge=t(70885),ie=t(22522),E=t(27361),F=t.n(E),Z=t(57557),re=t.n(Z),ne=t(48474);const Fe=v.default.div`
  position: relative;

  ${({hasConditions:o,disabled:n,theme:a})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${n?a.colors.neutral100:a.colors.primary600};
    }
  `}
`,je=({onClick:o,className:n,hasConditions:a,variant:i})=>{const{formatMessage:r}=(0,z.useIntl)();return e.createElement(Fe,{hasConditions:a,className:n},e.createElement(c.Button,{variant:i,startIcon:e.createElement(ie.Cog,null),onClick:o},r({id:"global.settings",defaultMessage:"Settings"})))};je.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},je.propTypes={onClick:s().func.isRequired,className:s().string,hasConditions:s().bool,variant:s().string};const x=(0,v.default)(je)``;var le=t(18172),H=t(7739),f=t.n(H),D=t(11700),Q=t.n(D);const Se=o=>Object.values(o).map(n=>Object.entries(n).filter(([,a])=>a).map(([a])=>a)).flat(),P=o=>o.reduce((n,[a,i])=>(n.push({label:Q()(a),children:i.map(r=>({label:r.displayName,value:r.id}))}),n),[]),w=(o,n)=>o.map(([,a])=>a).flat().reduce((a,i)=>({[i.id]:n.includes(i.id),...a}),{});var Y=function(){return window&&window.strapi&&window.strapi.isEE?t(53273).Z:t(79578).Z}(),q=function(n){var a=n.arrayOfOptionsGroupedByCategory,i=n.isFormDisabled,r=n.isGrey,d=n.label,p=n.name,h=n.onChange,S=n.value,T=(0,z.useIntl)(),R=T.formatMessage,I=function(G){h(p,w(a,G))};return e.createElement(c.Flex,{as:"li",background:r?"neutral100":"neutral0",paddingBottom:3,paddingTop:3},e.createElement(c.Flex,{paddingLeft:6,style:{width:180}},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},R({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(c.Typography,{variant:"sigma",title:d,textColor:"primary600",ellipsis:!0},R({id:"Settings.roles.form.permissions.".concat(d.toLowerCase()),defaultMessage:d})),e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",R({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(c.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(c.MultiSelectNested,{id:p,customizeContent:function(G){return"".concat(G.length," currently selected")},onChange:I,value:Se(S),options:P(a),disabled:i||Y})))};q.propTypes={arrayOfOptionsGroupedByCategory:s().array.isRequired,isFormDisabled:s().bool.isRequired,isGrey:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,value:s().object.isRequired,onChange:s().func.isRequired};const ye=q;var b=t(96486);const de=(o,n)=>o.reduce((a,i)=>(a[i.id]=(0,b.get)(n,i.id,!1),a),{}),Be=(o,n)=>o.reduce((a,i)=>{const[r,d]=i,p=de(d,n);return a[r]=p,a},{}),ue=(o,n,a)=>o.reduce((i,r)=>{const d=(0,b.get)(n,[...r.pathToConditionsObject,"conditions"],{}),p=Be(a,d);return i[r.pathToConditionsObject.join("..")]=p,i},{}),Me=({actions:o,headerBreadCrumbs:n,isFormDisabled:a,onClosed:i,onToggle:r})=>{const{formatMessage:d}=(0,z.useIntl)(),{availableConditions:p,modifiedData:h,onChangeConditions:S}=(0,ne.$_)(),T=(0,e.useMemo)(()=>Object.entries(f()(p,"category")),[p]),R=o.filter(({isDisplayed:O,hasSomeActionsSelected:$,hasAllActionsSelected:J})=>O&&($||J)),I=(0,e.useMemo)(()=>ue(R,h,T),[R,h,T]),[B,G]=(0,e.useState)(I),k=(O,$)=>{G((0,le.default)(J=>{J[O]||(J[O]={}),J[O].default||(J[O].default={}),J[O].default=$}))},V=()=>{const O=Object.entries(B).reduce(($,J)=>{const[he,Ne]=J,Re=Object.values(Ne).reduce((ve,xe)=>({...ve,...xe}),{});return $[he]=Re,$},{});S(O),r()};return e.createElement(c.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:i},e.createElement(c.ModalHeader,null,e.createElement(c.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:n.join(", ")},n.map(O=>e.createElement(c.Crumb,{key:O},Q()(d({id:O,defaultMessage:O})))))),e.createElement(c.ModalBody,null,R.length===0&&e.createElement(c.Typography,null,d({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,R.map(({actionId:O,label:$,pathToConditionsObject:J},he)=>{const Ne=J.join("..");return e.createElement(ye,{key:O,arrayOfOptionsGroupedByCategory:T,label:$,isFormDisabled:a,isGrey:he%2===0,name:Ne,onChange:k,value:F()(B,Ne,{})})}))),e.createElement(c.ModalFooter,{startActions:e.createElement(c.Button,{variant:"tertiary",onClick:r},d({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(c.Button,{onClick:V},d({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};Me.propTypes={actions:s().arrayOf(s().shape({actionId:s().string.isRequired,checkboxName:s().string,hasSomeActionsSelected:s().bool.isRequired,hasAllActionsSelected:s().bool,isDisplayed:s().bool.isRequired,label:s().string})).isRequired,headerBreadCrumbs:s().arrayOf(s().string).isRequired,isFormDisabled:s().bool.isRequired,onClosed:s().func.isRequired,onToggle:s().func.isRequired};const K=Me,me=`${120/16}rem`,Ue=`${200/16}rem`,We=`${53/16}rem`,_=v.default.div`
  width: ${me};
`,ct=(0,v.default)(c.Flex)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`,yt=({children:o,isCollapsable:n,isActive:a,isFormDisabled:i,label:r,onChange:d,onClick:p,checkboxName:h,someChecked:S,value:T})=>{const{formatMessage:R}=(0,z.useIntl)();return e.createElement(c.Flex,{alignItems:"center",paddingLeft:6,style:{width:Ue,flexShrink:0}},e.createElement(c.Box,{paddingRight:2},e.createElement(c.BaseCheckbox,{name:h,"aria-label":R({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:r}),disabled:i,onValueChange:I=>d({target:{name:h,value:I}}),indeterminate:S,value:T})),e.createElement(ct,{title:r,alignItems:"center",isCollapsable:n,...n&&{onClick:p,"aria-expanded":a,onKeyDown:({key:I})=>(I==="Enter"||I===" ")&&p(),tabIndex:0,role:"button"}},e.createElement(c.Typography,{fontWeight:a?"bold":"",textColor:a?"primary600":"neutral800",ellipsis:!0},Q()(r)),o))};yt.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},yt.propTypes={checkboxName:s().string,children:s().node,label:s().string.isRequired,isCollapsable:s().bool,isFormDisabled:s().bool.isRequired,onChange:s().func,onClick:s().func.isRequired,someChecked:s().bool,value:s().bool,isActive:s().bool.isRequired};const Et=(0,e.memo)(yt),at=o=>(0,b.isObject)(o)?(0,b.flattenDeep)(Object.values(o).map(n=>(0,b.isObject)(n)?at(n):n)):[],Ve=at,bt=o=>o?Object.keys(o).reduce((n,a)=>(a!=="conditions"&&(n[a]=o[a]),n),{}):null,He=o=>{const n=bt(o),a=Ve(n);if(!a.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const i=a.every(d=>d),r=a.some(d=>d)&&!i;return{hasAllActionsSelected:i,hasSomeActionsSelected:r}},ln=(o,n,a)=>o.map(({actionId:i,isDisplayed:r,applyToProperties:d,label:p})=>{if(!r)return{actionId:i,hasSomeActionsSelected:!1,isDisplayed:r};const h=[...a.split(".."),i],S=(0,b.isEmpty)(d)?[...h,"properties","enabled"]:h,T=S.join(".."),R=(0,b.get)(n,[...h,"conditions"],null),I=Ve(R).some(V=>V);if((0,b.isEmpty)(d)){const V=(0,b.get)(n,S,!1);return{actionId:i,checkboxName:T,hasAllActionsSelected:V,hasConditions:I,hasSomeActionsSelected:V,isDisplayed:r,isParentCheckbox:!1,label:p,pathToConditionsObject:h}}const B=(0,b.get)(n,S,null),{hasAllActionsSelected:G,hasSomeActionsSelected:k}=He(B);return{actionId:i,checkboxName:T,hasAllActionsSelected:G,hasConditions:I,hasSomeActionsSelected:k,isDisplayed:r,isParentCheckbox:!0,label:p,pathToConditionsObject:h}}),Ke=(0,v.default)(ie.CarretDown)`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,_e=o=>`
  ${c.Typography} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${Ke} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var St=function(){return window&&window.strapi&&window.strapi.isEE?t(20591).Z:t(56195).Z}(),It=function o(n,a){return`
  `.concat(dt,` {
    background-color: `).concat(n.colors.primary100,`;
    color: `).concat(n.colors.primary600,`;
    border-radius: `).concat(a?"2px 2px 0 0":"2px",`;
  }
  `).concat(Ft,` {
    display: flex;
  }
  `).concat(x,` {
    display: block;
  }
  &:hover {
   `).concat(_e(n),`
  }

  &:focus-within {
    `).concat(function(i){var r=i.theme,d=i.isActive;return o(r,d)},`
  }
  
`)},dt=v.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],We,function(o){var n=o.isGrey,a=o.theme;return n?a.colors.neutral100:a.colors.neutral0}),Ot=v.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],x,function(o){var n=o.isActive,a=o.theme;return n&&It(a,n)},function(o){var n=o.theme,a=o.isActive;return It(n,a)}),Tt=(0,v.default)(c.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],me),Ft=(0,v.default)(c.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var n=o.theme;return n.colors.primary600}),At=v.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var n=o.theme;return n.colors.primary600}),Bt=(0,v.default)(c.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),Rt=function(n){var a=n.availableActions,i=n.isActive,r=n.isGrey,d=n.isFormDisabled,p=n.label,h=n.onClickToggle,S=n.pathToData,T=(0,e.useState)(!1),R=(0,ge.Z)(T,2),I=R[0],B=R[1],G=(0,z.useIntl)(),k=G.formatMessage,V=(0,ne.$_)(),O=V.modifiedData,$=V.onChangeParentCheckbox,J=V.onChangeSimpleCheckbox,he=function(){B(function(Ee){return!Ee})},Ne=function(){B(!1)},Re=F()(O,S.split(".."),{}),ve=(0,e.useMemo)(function(){return Object.keys(Re).reduce(function(ae,Ee){return ae[Ee]=re()(Re[Ee],"conditions"),ae},{})},[Re]),xe=He(ve),Le=xe.hasAllActionsSelected,nt=xe.hasSomeActionsSelected,fe=(0,e.useMemo)(function(){return ln(a,O,S)},[a,O,S]),De=fe.some(function(ae){var Ee=ae.hasConditions;return Ee});return e.createElement(Ot,{isActive:i},e.createElement(dt,{isGrey:r},e.createElement(Et,{isCollapsable:!0,isFormDisabled:d,label:p,checkboxName:S,onChange:$,onClick:h,someChecked:nt,value:Le,isActive:i},e.createElement(Ft,{paddingLeft:2},i?e.createElement(ie.ChevronUp,null):e.createElement(ie.ChevronDown,null))),e.createElement(c.Flex,{style:{flex:1}},fe.map(function(ae){var Ee=ae.actionId,be=ae.hasConditions,Pe=ae.hasAllActionsSelected,Oe=ae.hasSomeActionsSelected,qe=ae.isDisplayed,$e=ae.isParentCheckbox,Xe=ae.checkboxName,it=ae.label;return qe?$e?e.createElement(Tt,{key:Ee,justifyContent:"center",alignItems:"center"},be&&e.createElement(At,null),e.createElement(c.BaseCheckbox,{disabled:d||St,name:Xe,"aria-label":k({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(it," ").concat(p)}),onValueChange:function(ot){$({target:{name:Xe,value:ot}})},indeterminate:Oe,value:Pe})):e.createElement(Tt,{key:Ee,justifyContent:"center",alignItems:"center"},be&&e.createElement(At,null),e.createElement(c.BaseCheckbox,{disabled:d||St,indeterminate:be,name:Xe,onValueChange:function(ot){J({target:{name:Xe,value:ot}})},value:Pe})):e.createElement(_,{key:Ee})})),I&&e.createElement(K,{headerBreadCrumbs:[p,"Settings.permissions.conditions.conditions"],actions:fe,isFormDisabled:d,onClosed:Ne,onToggle:he})),e.createElement(Bt,null,e.createElement(x,{onClick:he,hasConditions:De})))};Rt.propTypes={availableActions:s().array.isRequired,isActive:s().bool.isRequired,isGrey:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggle:s().func.isRequired,pathToData:s().string.isRequired};const kt=Rt,wt=(o,n)=>o.map(a=>{const i=Array.isArray(a.applyToProperties)&&a.applyToProperties.indexOf(n)!==-1&&a.isDisplayed;return{label:a.label,actionId:a.actionId,isActionRelatedToCurrentProperty:i}}),$t=(0,v.default)(c.Flex)`
  width: ${me};
  flex-shrink: 0;
`,Nt=(0,v.default)(c.Flex)`
  width: ${Ue};
  height: ${We};
  flex-shrink: 0;
`,jt=({headers:o,label:n})=>{const{formatMessage:a}=(0,z.useIntl)(),i=a({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:n});return e.createElement(c.Flex,null,e.createElement(Nt,{alignItems:"center",paddingLeft:6},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},i)),o.map(r=>r.isActionRelatedToCurrentProperty?e.createElement($t,{justifyContent:"center",key:r.label},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},a({id:`Settings.roles.form.permissions.${r.label.toLowerCase()}`,defaultMessage:r.label}))):e.createElement($t,{key:r.label})))};jt.propTypes={headers:s().arrayOf(s().shape({label:s().string.isRequired,isActionRelatedToCurrentProperty:s().bool.isRequired})).isRequired,label:s().string.isRequired};const Ut=jt;var et=t(42982);const Lt=v.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,Mt=()=>e.createElement(Lt,null,"*"),Wt=(o,n)=>o.map(a=>{const i=Array.isArray(a.subjects)&&a.subjects.indexOf(n)!==-1;return{...a,isDisplayed:i}});var Zt=t(87462);const zt=(0,v.default)(c.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,Gt=v.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:n})=>o.colors[n]};
  }
`,ut=o=>e.createElement(zt,null,e.createElement(Gt,{width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));ut.defaultProps={fill:"primary200"},ut.propTypes={fill:s().string};const Vt=(0,e.memo)(ut);var xt=function(){return window&&window.strapi&&window.strapi.isEE?t(76766).Z:t(28472).Z}(),mt=(0,v.default)(c.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],me),Ht=(0,v.default)(c.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],We),Dt=(0,v.default)(c.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),Kt=(0,v.default)(c.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var n=o.isVisible,a=o.theme;return n?"4px solid ".concat(a.colors.primary200):"4px solid transparent"}),C=(0,v.default)(c.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var n=o.theme;return n.spaces[4]},function(o){var n=o.level;return 145-n*36},function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ke,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(_e(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&_e(a)}),m=v.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var n=o.theme;return n.spaces[2]},function(o){var n=o.theme;return n.spaces[2]},4/16,function(o){var n=o.theme;return n.colors.primary200}),g=function o(n){var a=n.childrenForm,i=n.isFormDisabled,r=n.recursiveLevel,d=n.pathToDataFromActionRow,p=n.propertyActions,h=n.parentName,S=n.propertyName,T=(0,z.useIntl)(),R=T.formatMessage,I=(0,ne.$_)(),B=I.modifiedData,G=I.onChangeParentCheckbox,k=I.onChangeSimpleCheckbox,V=(0,e.useState)(null),O=(0,ge.Z)(V,2),$=O[0],J=O[1],he=function(ve){J(function(xe){return xe===ve?null:ve})},Ne=(0,e.useMemo)(function(){return $?a.find(function(Re){var ve=Re.value;return ve===$}):null},[$,a]);return e.createElement(Dt,null,e.createElement(m,null),a.map(function(Re,ve){var xe=Re.label,Le=Re.value,nt=Re.required,fe=Re.children,De=ve+1<a.length,ae=Array.isArray(fe),Ee=$===Le;return e.createElement(Kt,{key:Le,isVisible:De},e.createElement(Ht,null,e.createElement(Vt,{color:"primary200"}),e.createElement(c.Flex,{style:{flex:1}},e.createElement(C,{level:r,isActive:Ee,isCollapsable:ae},e.createElement(ct,(0,Zt.Z)({alignItems:"center",isCollapsable:ae},ae&&{onClick:function(){return he(Le)},"aria-expanded":Ee,onKeyDown:function(Pe){var Oe=Pe.key;return(Oe==="Enter"||Oe===" ")&&he(Le)},tabIndex:0,role:"button"},{title:xe}),e.createElement(c.Typography,{ellipsis:!0},Q()(xe)),nt&&e.createElement(Mt,null),e.createElement(Ke,{$isActive:Ee}))),e.createElement(c.Flex,{style:{flex:1}},p.map(function(be){var Pe=be.actionId,Oe=be.label,qe=be.isActionRelatedToCurrentProperty;if(!qe)return e.createElement(_,{key:Pe});var $e=[].concat((0,et.Z)(d.split("..")),[Pe,"properties",S],(0,et.Z)(h.split("..")),[Le]),Xe=F()(B,$e,!1);if(!fe)return e.createElement(mt,{key:Oe,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:i||xt,name:$e.join(".."),"aria-label":R({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(xe," ").concat(Oe)}),onValueChange:function(Ct){k({target:{name:$e.join(".."),value:Ct}})},value:Xe}));var it=He(Xe),rt=it.hasAllActionsSelected,ot=it.hasSomeActionsSelected;return e.createElement(mt,{key:Oe,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{key:Oe,disabled:i||xt,name:$e.join(".."),"aria-label":R({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(xe," ").concat(Oe)}),onValueChange:function(Ct){G({target:{name:$e.join(".."),value:Ct}})},value:rt,indeterminate:ot}))})))),Ne&&Ee&&e.createElement(c.Box,{paddingBottom:2},e.createElement(o,{isFormDisabled:i,parentName:"".concat(h,"..").concat(Le),pathToDataFromActionRow:d,propertyActions:p,propertyName:S,recursiveLevel:r+1,childrenForm:Ne.children})))}))};g.propTypes={childrenForm:s().array.isRequired,isFormDisabled:s().bool.isRequired,parentName:s().string.isRequired,pathToDataFromActionRow:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,recursiveLevel:s().number.isRequired};const A=(0,e.memo)(g),u=o=>o.reduce((a,i)=>(i.isActionRelatedToCurrentProperty&&a.push(i.actionId),a),[]),U=(o,n,a,i,r)=>{const p=u(o).reduce((h,S)=>{const T=[...a.split(".."),S,"properties",i,r],R=(0,b.get)(n,T,!1);return h[S]=R,h},{});return He(p)};var X=function(){return window&&window.strapi&&window.strapi.isEE?t(74512).Z:t(35820).Z}(),N=(0,v.default)(c.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],me),j=(0,v.default)(c.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],We,function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ke,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(_e(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&_e(a)}),Ae=function(n){var a=n.childrenForm,i=n.label,r=n.isFormDisabled,d=n.name,p=n.required,h=n.pathToData,S=n.propertyActions,T=n.propertyName,R=n.isOdd,I=(0,z.useIntl)(),B=I.formatMessage,G=(0,e.useState)(null),k=(0,ge.Z)(G,2),V=k[0],O=k[1],$=(0,ne.$_)(),J=$.modifiedData,he=$.onChangeCollectionTypeLeftActionRowCheckbox,Ne=$.onChangeParentCheckbox,Re=$.onChangeSimpleCheckbox,ve=V===d,xe=(0,e.useMemo)(function(){return Array.isArray(a)?a:[]},[a]),Le=xe.length>0,nt=(0,e.useCallback)(function(){Le&&O(function(be){return be===d?null:d})},[Le,d]),fe=function(Pe){var Oe=Pe.target.value;he(h,T,d,Oe)},De=(0,e.useMemo)(function(){return U(S,J,h,T,d)},[S,J,h,T,d]),ae=De.hasAllActionsSelected,Ee=De.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(j,{alignItems:"center",isCollapsable:Le,isActive:ve,background:R?"neutral100":"neutral0"},e.createElement(c.Flex,null,e.createElement(Et,{onChange:fe,onClick:nt,isCollapsable:Le,isFormDisabled:r,label:i,someChecked:Ee,value:ae,isActive:ve},p&&e.createElement(Mt,null),e.createElement(Ke,{$isActive:ve})),e.createElement(c.Flex,null,S.map(function(be){var Pe=be.label,Oe=be.isActionRelatedToCurrentProperty,qe=be.actionId;if(!Oe)return e.createElement(_,{key:Pe});var $e=[].concat((0,et.Z)(h.split("..")),[qe,"properties",T,d]);if(!Le){var Xe=F()(J,$e,!1);return e.createElement(N,{key:qe,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:r||X,name:$e.join(".."),"aria-label":B({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(Pe)}),onValueChange:function(an){Re({target:{name:$e.join(".."),value:an}})},value:Xe}))}var it=F()(J,$e,{}),rt=He(it),ot=rt.hasAllActionsSelected,on=rt.hasSomeActionsSelected;return e.createElement(N,{key:Pe,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:r||X,name:$e.join(".."),onValueChange:function(an){Ne({target:{name:$e.join(".."),value:an}})},"aria-label":B({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(Pe)}),value:ot,indeterminate:on}))})))),ve&&e.createElement(A,{childrenForm:xe,isFormDisabled:r,parentName:d,pathToDataFromActionRow:h,propertyName:T,propertyActions:S,recursiveLevel:0}))};Ae.defaultProps={childrenForm:[],required:!1},Ae.propTypes={childrenForm:s().array,label:s().string.isRequired,isFormDisabled:s().bool.isRequired,name:s().string.isRequired,pathToData:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,required:s().bool,isOdd:s().bool.isRequired};const ce=(0,e.memo)(Ae),we=v.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Ie=({availableActions:o,childrenForm:n,isFormDisabled:a,label:i,pathToData:r,propertyName:d})=>{const p=(0,e.useMemo)(()=>wt(o,d),[o,d]);return e.createElement(we,null,e.createElement(Ut,{label:i,headers:p}),e.createElement(c.Box,null,n.map(({children:h,label:S,value:T,required:R},I)=>e.createElement(ce,{childrenForm:h,key:T,label:S,isFormDisabled:a,name:T,required:R,propertyActions:p,pathToData:r,propertyName:d,isOdd:I%2===0}))))};Ie.propTypes={childrenForm:s().array.isRequired,availableActions:s().array.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,pathToData:s().string.isRequired,propertyName:s().string.isRequired};const Ze=Ie,Ge=v.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:n})=>n&&`border: 1px solid ${o.colors.primary600};`}
`,ze=({allActions:o,contentTypeName:n,label:a,index:i,isActive:r,isFormDisabled:d,onClickToggleCollapse:p,pathToData:h,properties:S})=>{const T=(0,e.useCallback)(()=>{p(n)},[n,p]),R=(0,e.useMemo)(()=>Wt(o,n),[o,n]);return e.createElement(Ge,{isActive:r},e.createElement(kt,{availableActions:R,isActive:r,isGrey:i%2===0,isFormDisabled:d,label:a,onClickToggle:T,pathToData:h}),r&&S.map(({label:I,value:B,children:G})=>e.createElement(Ze,{availableActions:R,childrenForm:G,isFormDisabled:d,label:I,pathToData:h,propertyName:B,key:B})))};ze.propTypes={allActions:s().array.isRequired,contentTypeName:s().string.isRequired,index:s().number.isRequired,isActive:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggleCollapse:s().func.isRequired,pathToData:s().string.isRequired,properties:s().array.isRequired};const pt=ze,gt=({actions:o,isFormDisabled:n,pathToData:a,subjects:i})=>{const[r,d]=(0,e.useState)(null),p=h=>{d(r===h?null:h)};return i.map(({uid:h,label:S,properties:T},R)=>e.createElement(pt,{allActions:o,key:h,contentTypeName:h,label:S,isActive:r===h,isFormDisabled:n,index:R,onClickToggleCollapse:p,pathToData:`${a}..${h}`,properties:T}))};gt.defaultProps={actions:[],subjects:[]},gt.propTypes={actions:s().array.isRequired,isFormDisabled:s().bool.isRequired,pathToData:s().string.isRequired,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))};const Xt=(0,e.memo)(gt),Yt=o=>o.filter(({subjects:n})=>n&&n.length),Jt=o=>o.map(({actionId:n})=>n),ht=(o,n)=>o.reduce((a,i)=>(Object.keys(n).forEach(r=>{const d=(0,b.get)(n,[r,i],{}),p={[r]:bt(d)};a[i]?a[i]={...a[i],...p}:a[i]=p}),a),{}),tt=(o,n)=>{const a=Jt(o),i=ht(a,n);return Object.keys(i).reduce((d,p)=>(d[p]=He(i[p]),d),{})};var Qe=function(){return window&&window.strapi&&window.strapi.isEE?t(85822).Z:t(99047).Z}(),Ye=(0,v.default)(c.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],me),st=function(n){var a=n.actions,i=n.isFormDisabled,r=n.kind,d=(0,z.useIntl)(),p=d.formatMessage,h=(0,ne.$_)(),S=h.modifiedData,T=h.onChangeCollectionTypeGlobalActionCheckbox,R=(0,e.useMemo)(function(){return Yt(a)},[a]),I=(0,e.useMemo)(function(){return tt(R,S[r])},[S,R,r]);return e.createElement(c.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Ue}},e.createElement(c.Stack,{horizontal:!0,spacing:0},R.map(function(B){var G=B.label,k=B.actionId;return e.createElement(Ye,{key:k,spacing:3},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},p({id:"Settings.roles.form.permissions.".concat(G.toLowerCase()),defaultMessage:G})),e.createElement(c.BaseCheckbox,{disabled:i||Qe,onValueChange:function(O){T(r,k,O)},name:k,"aria-label":p({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:p({id:"Settings.roles.form.permissions.".concat(G.toLowerCase()),defaultMessage:G})}),value:F()(I,[k,"hasAllActionsSelected"],!1),indeterminate:F()(I,[k,"hasSomeActionsSelected"],!1)}))})))};st.defaultProps={actions:[]},st.propTypes={actions:s().arrayOf(s().shape({label:s().string.isRequired,actionId:s().string.isRequired,subjects:s().array.isRequired})),isFormDisabled:s().bool.isRequired,kind:s().string.isRequired};const Je=(0,e.memo)(st),On=(0,v.default)(c.Box)`
  overflow-x: auto;
`,gn=({isFormDisabled:o,kind:n,layout:{actions:a,subjects:i}})=>{const r=te()([...i],"label");return e.createElement(On,{background:"neutral0"},e.createElement(Je,{actions:a,kind:n,isFormDisabled:o}),e.createElement(Xt,{actions:a,isFormDisabled:o,pathToData:n,subjects:r}))};gn.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().shape({actions:s().array,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))}).isRequired};const hn=(0,e.memo)(gn);var Fn=t(47713);const fn=({children:o,value:n})=>e.createElement(Fn.$l.Provider,{value:n},o);fn.propTypes={children:s().node.isRequired,value:s().exact({availableConditions:s().array.isRequired,modifiedData:s().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:s().func.isRequired,onChangeConditions:s().func.isRequired,onChangeSimpleCheckbox:s().func.isRequired,onChangeParentCheckbox:s().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:s().func.isRequired}).isRequired};const Bn=fn,kn=(o,n,a)=>o.map(i=>{const r=[...a,i.action,"properties","enabled"],d=(0,b.get)(n,r,!1),p=(0,b.get)(n,[...a,i.action,"conditions"],{}),h=Ve(p).some(S=>S);return{...i,isDisplayed:d,checkboxName:r.join(".."),hasSomeActionsSelected:d,value:d,hasConditions:h,label:i.displayName,actionId:i.action,pathToConditionsObject:[...a,i.action]}}),wn=o=>{const n=Object.entries(o).reduce((i,r)=>{const[d,{conditions:p}]=r;return i[d]=p,i},{});return Ve(n).some(i=>i)};var qt=function(){return window&&window.strapi&&window.strapi.isEE?t(8629).Z:t(34341).Z}(),$n=v.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var n=o.theme;return n.colors.neutral150}),Nn=v.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var n=o.hasConditions,a=o.disabled,i=o.theme;return n&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(a?i.colors.neutral100:i.colors.primary600,`;
    }
  `)}),Cn=function(n){var a=n.categoryName,i=n.isFormDisabled,r=n.subCategoryName,d=n.actions,p=n.pathToData,h=(0,e.useState)(!1),S=(0,ge.Z)(h,2),T=S[0],R=S[1],I=(0,ne.$_)(),B=I.modifiedData,G=I.onChangeParentCheckbox,k=I.onChangeSimpleCheckbox,V=(0,z.useIntl)(),O=V.formatMessage,$=F()(B,p,{}),J=(0,e.useMemo)(function(){return Object.keys($).reduce(function(fe,De){return fe[De]=bt($[De]),fe},{})},[$]),he=He(J),Ne=he.hasAllActionsSelected,Re=he.hasSomeActionsSelected,ve=function(){R(function(De){return!De})},xe=function(){R(!1)},Le=kn(d,B,p),nt=wn(F()(B,(0,et.Z)(p),{}));return e.createElement(e.Fragment,null,e.createElement(c.Box,null,e.createElement(c.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(c.Box,{paddingRight:4},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},r)),e.createElement($n,null),e.createElement(c.Box,{paddingLeft:4},e.createElement(c.Checkbox,{name:p.join(".."),disabled:i||qt,onValueChange:function(De){G({target:{name:p.join(".."),value:De}})},indeterminate:Re,value:Ne},O({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(c.Flex,{paddingTop:6,paddingBottom:6},e.createElement(c.Grid,{gap:2,style:{flex:1}},Le.map(function(fe){var De=fe.checkboxName,ae=fe.value,Ee=fe.action,be=fe.displayName,Pe=fe.hasConditions;return e.createElement(c.GridItem,{col:3,key:Ee},e.createElement(Nn,{disabled:i||qt,hasConditions:Pe},e.createElement(c.Checkbox,{name:De,disabled:i||qt,onValueChange:function(qe){k({target:{name:De,value:qe}})},value:ae},be)))})),e.createElement(x,{hasConditions:nt,onClick:ve}))),T&&e.createElement(K,{headerBreadCrumbs:[a,r],actions:Le,isFormDisabled:i,onClosed:xe,onToggle:ve}))};Cn.propTypes={actions:s().array.isRequired,categoryName:s().string.isRequired,isFormDisabled:s().bool.isRequired,subCategoryName:s().string.isRequired,pathToData:s().array.isRequired};const jn=Cn,_t=({childrenForm:o,kind:n,name:a,isOpen:i,isFormDisabled:r,isWhite:d,onOpenCategory:p,pathToData:h})=>{const{formatMessage:S}=(0,z.useIntl)(),T=()=>{p(a)},R=(0,e.useMemo)(()=>a.split("::").pop(),[a]);return e.createElement(c.Accordion,{expanded:i,onToggle:T,id:`accordion-${a}`,variant:d?"primary":"secondary"},e.createElement(c.AccordionToggle,{title:Q()(R),description:`${S({id:"Settings.permissions.category"},{category:R})} ${n==="plugins"?"plugin":n}`}),e.createElement(c.AccordionContent,null,e.createElement(c.Box,{padding:6},o.map(({actions:I,subCategoryName:B,subCategoryId:G})=>e.createElement(jn,{key:B,actions:I,categoryName:R,isFormDisabled:r,subCategoryName:B,pathToData:[...h,G]})))))};_t.defaultProps={},_t.propTypes={childrenForm:s().array.isRequired,isOpen:s().bool.isRequired,isFormDisabled:s().bool.isRequired,isWhite:s().bool.isRequired,kind:s().string.isRequired,name:s().string.isRequired,onOpenCategory:s().func.isRequired,pathToData:s().array.isRequired};const Un=_t,yn=({isFormDisabled:o,kind:n,layout:a})=>{const[i,r]=(0,e.useState)(null),d=p=>{r(p===i?null:p)};return e.createElement(c.Box,{padding:6,background:"neutral0"},a.map(({category:p,categoryId:h,childrenForm:S},T)=>e.createElement(Un,{key:p,childrenForm:S,kind:n,isFormDisabled:o,isOpen:i===p,isWhite:T%2===1,name:p,onOpenCategory:d,pathToData:[n,h]})))};yn.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().arrayOf(s().shape({category:s().string.isRequired,categoryId:s().string.isRequired,childrenForm:s().arrayOf(s().shape({actions:s().array.isRequired})).isRequired}).isRequired).isRequired};const En=yn,vn=(o,n,a)=>o.find(i=>i.action===n&&i.subject===a),bn=(o,n=[])=>o.reduce((a,i)=>(a[i.id]=n.indexOf(i.id)!==-1,a),{}),Sn=({children:o},n,a="")=>o.reduce((i,r)=>{if(r.children)return{...i,[r.value]:Sn(r,n,`${a}${r.value}.`)};const d=n.indexOf(`${a}${r.value}`)!==-1;return i[r.value]=d,i},{}),Wn=(o,n,a)=>o.reduce((i,r)=>{const d=n.properties.find(({value:p})=>p===r);if(d){const p=(0,b.get)(a,["properties",d.value],[]),h=Sn(d,p);i.properties[r]=h}return i},{properties:{}}),Zn=(o,n)=>n.reduce((a,i)=>{const r=o.find(({uid:d})=>d===i)||null;return r&&(a[i]=r),a},{}),Tn=({subjects:o},n,a,i=[])=>n.reduce((r,d)=>{const p=d.subjects,h=Zn(o,p);if((0,b.isEmpty)(h))return r;const S=Object.keys(h).reduce((T,R)=>{const{actionId:I,applyToProperties:B}=d,V=h[R].properties.map(({value:he})=>he).every(he=>(B||[]).indexOf(he)===-1),O=vn(i,I,R),$=bn(a,(0,b.get)(O,"conditions",[]));if((0,b.isEmpty)(B)||V)return(0,b.set)(T,[R,I],{properties:{enabled:O!==void 0},conditions:$}),T;const J=Wn(B,h[R],O);return(0,b.set)(T,[R,I],{...J,conditions:$}),T},{});return(0,b.merge)(r,S)},{}),zn=(o,n,a)=>o.reduce((i,r)=>{const d=vn(a,r.action,null);return i[r.action]={properties:{enabled:d!==void 0},conditions:bn(n,(0,b.get)(d,"conditions",[]))},i},{}),Gn=(o,n,a)=>o.reduce((i,r)=>(i[r.subCategoryId]=zn(r.actions,n,a),i),{}),An=(o,n,a=[])=>o.reduce((i,{categoryId:r,childrenForm:d})=>{const p=Gn(d,n,a);return i[r]=p,i},{}),Rn=o=>o.split(" ").join("-"),Ln=(o,n)=>Object.entries(f()(o,n)).map(([a,i])=>({category:a,categoryId:Rn(a),childrenForm:Object.entries(f()(i,"subCategory")).map(([r,d])=>({subCategoryName:r,subCategoryId:Rn(r),actions:d}))})),Vn=(o,n)=>{const{conditions:a,sections:{collectionTypes:i,singleTypes:r,plugins:d,settings:p}}=o,h={collectionTypes:i,singleTypes:r,plugins:Ln(d,"plugin"),settings:Ln(p,"category")},S={collectionTypes:Tn(i,i.actions||[],a,n),singleTypes:Tn(r,r.actions||[],a,n),plugins:An(h.plugins,a,n),settings:An(h.settings,a,n)};return{initialData:S,modifiedData:S,layouts:h}},Mn=o=>Object.keys(o).reduce((n,a)=>{const i=o[a];if((0,b.isObject)(i)&&!(0,b.has)(i,"conditions"))return{...n,[a]:Mn(i)};if((0,b.isObject)(i)&&(0,b.has)(i,"conditions")&&!Ve((0,b.omit)(i,"conditions")).some(d=>d)){const d=Object.keys(i.conditions).reduce((p,h)=>(p[h]=!1,p),{});return{...n,[a]:{...i,conditions:d}}}return n[a]=i,n},{}),en=Mn,xn=(o,n)=>Object.keys(o).reduce((a,i)=>{const r=o[i];return i==="conditions"?(a[i]=r,a):(0,b.isObject)(r)?{...a,[i]:xn(r,n)}:(a[i]=n,a)},{}),Pt=xn,Hn={initialData:{},modifiedData:{},layouts:{}},Kn=(o,n)=>(0,le.default)(o,a=>{switch(n.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:i,actionId:r,value:d}=n,p=["modifiedData",i];Object.keys((0,b.get)(o,p)).forEach(h=>{const S=(0,b.get)(o,[...p,h,r],void 0);if(S){let T=Pt(S,d);if(!d&&T.conditions){const R=Pt(T.conditions,!1);T={...T,conditions:R}}(0,b.set)(a,[...p,h,r],T)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:i,propertyName:r,rowName:d,value:p}=n;let h=(0,b.cloneDeep)(o.modifiedData);const S=i.split(".."),T=(0,b.get)(h,S,{});Object.keys(T).forEach(R=>{if((0,b.has)(T[R],`properties.${r}`)){const I=(0,b.get)(T,[R,"properties",r,d]),B=[...S,R,"properties",r,d];if(!(0,b.isObject)(I))(0,b.set)(h,B,p);else{const G=Pt(I,p);(0,b.set)(h,B,G)}}}),p||(h=en(h)),(0,b.set)(a,"modifiedData",h);break}case"ON_CHANGE_CONDITIONS":{Object.entries(n.conditions).forEach(i=>{const[r,d]=i;(0,b.set)(a,["modifiedData",...r.split(".."),"conditions"],d)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let i=(0,b.cloneDeep)(o.modifiedData);(0,b.set)(i,[...n.keys.split("..")],n.value),n.value||(i=en(i)),(0,b.set)(a,"modifiedData",i);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:i,value:r}=n,d=[...i.split("..")];let p=(0,b.cloneDeep)(o.modifiedData);const h=(0,b.get)(p,d,{}),S=Pt(h,r);(0,b.set)(p,d,S),r||(p=en(p)),(0,b.set)(a,["modifiedData"],p);break}case"RESET_FORM":{a.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{a.initialData=o.modifiedData;break}default:return a}}),tn=o=>Object.entries(o).filter(([,n])=>n).map(([n])=>n),Xn=o=>{const[n,{conditions:a}]=o;return{action:n,subject:null,conditions:tn(a),properties:{}}},Qn=o=>Object.values(o).reduce((n,a)=>{const i=Object.entries(a).reduce((r,d)=>{const[,{properties:{enabled:p}}]=d;if(!p)return r;const h=Xn(d);return r.push(h),r},[]);return[...n,...i]},[]),Dn=o=>Object.values(o).reduce((n,a)=>{const i=Qn(a);return[...n,...i]},[]),Pn=(o,n="")=>Object.entries(o).reduce((a,i)=>{const[r,d]=i;return(0,b.isObject)(d)?[...a,...Pn(d,`${n}${r}.`)]:(d&&!(0,b.isObject)(d)&&a.push(`${n}${r}`),a)},[]),Yn=(o,n,{conditions:a,properties:i})=>Object.entries(i).reduce((r,d)=>{const[p,h]=d;return r.properties[p]=Pn(h),r},{action:o,subject:n,conditions:tn(a),properties:{}}),Jn=(o,n,{conditions:a})=>({action:o,subject:n,properties:{},conditions:tn(a)}),qn=(o,n)=>Object.entries(n).reduce((i,r)=>{const[d,p]=r;if(!Ve(p).some(T=>T))return i;if(!(0,b.has)(p,"properties.enabled")){const T=Yn(d,o,p);return[...i,T]}if(!p.properties.enabled)return i;const S=Jn(d,o,p);return i.push(S),i},[]),In=o=>Object.entries(o).reduce((a,i)=>{const[r,d]=i,p=qn(r,d);return[...a,...p]},[]),_n=o=>{const n=Dn(o.plugins),a=Dn(o.settings),i=In(o.collectionTypes),r=In(o.singleTypes);return[...n,...a,...i,...r]},eo=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}],nn=(0,e.forwardRef)(({layout:o,isFormDisabled:n,permissions:a},i)=>{const[{initialData:r,layouts:d,modifiedData:p},h]=(0,e.useReducer)(Kn,Hn,()=>Vn(o,a)),{formatMessage:S}=(0,z.useIntl)();(0,e.useImperativeHandle)(i,()=>({getPermissions(){const k=(0,l.difference)(r.collectionTypes,p.collectionTypes),V=(0,l.difference)(r.singleTypes,p.singleTypes),O={...k,...V};let $;return W()(O)?$=!1:$=Object.values(O).some(J=>Object.values(J).some(he=>Ce()(he,"conditions"))),{permissionsToSend:_n(p),didUpdateConditions:$}},resetForm(){h({type:"RESET_FORM"})},setFormAfterSubmit(){h({type:"SET_FORM_AFTER_SUBMIT"})}}));const T=(k,V,O,$)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:k,propertyName:V,rowName:O,value:$})},R=(k,V,O)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:k,actionId:V,value:O})},I=k=>{h({type:"ON_CHANGE_CONDITIONS",conditions:k})},B=(0,e.useCallback)(({target:{name:k,value:V}})=>{h({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:k,value:V})},[]),G=(0,e.useCallback)(({target:{name:k,value:V}})=>{h({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:k,value:V})},[]);return e.createElement(Bn,{value:{availableConditions:o.conditions,modifiedData:p,onChangeConditions:I,onChangeSimpleCheckbox:B,onChangeParentCheckbox:G,onChangeCollectionTypeLeftActionRowCheckbox:T,onChangeCollectionTypeGlobalActionCheckbox:R}},e.createElement(c.TabGroup,{id:"tabs",label:S({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(c.Tabs,null,eo.map(k=>e.createElement(c.Tab,{key:k.id},S({id:k.labelId,defaultMessage:k.defaultMessage})))),e.createElement(c.TabPanels,{style:{position:"relative"}},e.createElement(c.TabPanel,null,e.createElement(hn,{layout:d.collectionTypes,kind:"collectionTypes",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(hn,{layout:d.singleTypes,kind:"singleTypes",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(En,{layout:d.plugins,kind:"plugins",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(En,{layout:d.settings,kind:"settings",isFormDisabled:n})))))});nn.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},nn.propTypes={layout:s().object,isFormDisabled:s().bool.isRequired,permissions:s().array};const to=(0,e.memo)(nn)},34341:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!0},67500:(ee,L,t)=>{t.d(L,{Z:()=>e});const e=()=>"todo empty role"},52351:(ee,L,t)=>{t.d(L,{Z:()=>z});var e=t(67294),y=t(45697),s=t.n(y),l=t(72899),c=t.n(l),M=t(27298),Ce=t.n(M),se=t(49212);const W=({id:v,name:pe,description:te,usersCount:ge,icons:ie,rowIndex:E})=>{const{formatMessage:F}=(0,se.useIntl)(),Z=F({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:ge});return e.createElement(l.Tr,{"aria-rowindex":E,key:v,...(0,M.onRowClick)({fn:ie[1].onClick})},e.createElement(l.Td,{maxWidth:(0,M.pxToRem)(130)},e.createElement(l.Typography,{ellipsis:!0,textColor:"neutral800"},pe)),e.createElement(l.Td,{maxWidth:(0,M.pxToRem)(250)},e.createElement(l.Typography,{ellipsis:!0,textColor:"neutral800"},te)),e.createElement(l.Td,null,e.createElement(l.Typography,{textColor:"neutral800"},Z)),e.createElement(l.Td,null,e.createElement(l.Flex,{justifyContent:"flex-end",...M.stopPropagation},ie.map((re,ne)=>re?e.createElement(l.Box,{key:re.label,paddingLeft:ne===0?0:1},e.createElement(l.IconButton,{onClick:re.onClick,label:re.label,noBorder:!0,icon:re.icon})):null))))};W.propTypes={id:s().number.isRequired,name:s().string.isRequired,description:s().string.isRequired,usersCount:s().number.isRequired,icons:s().array.isRequired,rowIndex:s().number.isRequired};const z=W},85302:(ee,L,t)=>{t.d(L,{Z:()=>Se});var e=t(67294),y=t(27298),s=t(87751),l=t(63852),c=t(22522),M=t(72899),Ce=t(49212),se=t(49656),W=t(52351),z=t(67500),v=t(45697),pe=t.n(v),te=t(71893),ge=t(78324);const ie=t.p+"6d21938306785f176538.png",E=t.p+"617f9c948fa79e6d73bd.png",F=te.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:P})=>(0,y.setHexOpacity)(P.colors.neutral800,.2)};
  padding: 0 ${({theme:P})=>P.spaces[8]};
`,Z=(0,te.default)(M.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,re=(0,te.default)(M.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,ne=(0,te.default)(M.Box)`
  position: absolute;
  right: ${({theme:P})=>P.spaces[4]};
  top: ${({theme:P})=>P.spaces[4]};
`,Fe=({onClose:P,isOpen:w})=>{(0,y.useLockScroll)(w);const{formatMessage:Y}=(0,Ce.useIntl)();return w?e.createElement(M.Portal,null,e.createElement(F,{onClick:P},e.createElement(M.FocusTrap,{onEscape:P},e.createElement(Z,{onClick:q=>q.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:ie,alt:"air-balloon"}),e.createElement(ne,null,e.createElement(M.IconButton,{onClick:P,"aria-label":"Close",icon:e.createElement(c.Cross,null)})),e.createElement(re,{spacing:6},e.createElement(M.Typography,{fontWeight:"bold",textColor:"primary600"},Y({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(M.Stack,{spacing:2},e.createElement(M.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},Y({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(M.Typography,null,Y({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(ge.Q,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(c.ExternalLink,null)},Y({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:E,alt:"upgrade-arrow"}))))):null};Fe.propTypes={onClose:pe().func.isRequired,isOpen:pe().bool.isRequired};const je=Fe;var x=t(48474);const le=()=>{const{roles:P,isLoading:w}=(0,x.bF)(),Y=(0,y.useQuery)(),q=decodeURIComponent(Y.get("_q")||""),ye=(0,l.ZP)(P,q,{keys:["name","description"]});return{isLoading:w,sortedRoles:ye}},H=()=>{const{formatMessage:P}=(0,Ce.useIntl)(),[w,Y]=(0,e.useState)(!1),{trackUsage:q}=(0,y.useTracking)(),{push:ye}=(0,se.useHistory)(),b=(0,e.useCallback)(ue=>{ye(`/settings/roles/${ue}`)},[ye]),de=(0,e.useCallback)(()=>{Y(ue=>!ue)},[]),Be=(0,e.useCallback)(()=>{q("didShowRBACUpgradeModal"),Y(!0)},[q]),ke=(0,e.useCallback)(ue=>[{onClick:de,label:P({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(c.Duplicate,null)},{onClick:()=>b(ue.id),label:P({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(c.Pencil,null)},{onClick:de,label:P({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(c.Trash,null)}],[P,de,b]);return{isModalOpen:w,handleToggleModalForCreatingRole:Be,handleToggle:de,getIcons:ke}},D=()=>{const{formatMessage:P}=(0,Ce.useIntl)();(0,y.useFocusWhenNavigate)();const{sortedRoles:w,isLoading:Y}=le(),{isModalOpen:q,handleToggle:ye,handleToggleModalForCreatingRole:b,getIcons:de}=H(),Be=w.length+1,ke=5;return e.createElement(M.Main,null,e.createElement(y.SettingsPageTitle,{name:"Roles"}),e.createElement(M.HeaderLayout,{primaryAction:e.createElement(M.Button,{onClick:b,startIcon:e.createElement(c.Plus,null),size:"S"},P({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:P({id:"global.roles",defaultMessage:"roles"}),subtitle:P({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(M.ContentLayout,null,e.createElement(M.Table,{colCount:ke,rowCount:Be,footer:e.createElement(M.TFooter,{onClick:b,icon:e.createElement(c.Plus,null)},P({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(M.Thead,null,e.createElement(M.Tr,null,e.createElement(M.Th,null,e.createElement(M.Typography,{variant:"sigma",textColor:"neutral600"},P({id:"global.name",defaultMessage:"Name"}))),e.createElement(M.Th,null,e.createElement(M.Typography,{variant:"sigma",textColor:"neutral600"},P({id:"global.description",defaultMessage:"Description"}))),e.createElement(M.Th,null,e.createElement(M.Typography,{variant:"sigma",textColor:"neutral600"},P({id:"global.users",defaultMessage:"Users"}))),e.createElement(M.Th,null,e.createElement(M.VisuallyHidden,null,P({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(M.Tbody,null,w?.map((ue,Me)=>e.createElement(W.Z,{key:ue.id,id:ue.id,name:ue.name,description:ue.description,usersCount:ue.usersCount,icons:de(ue),rowIndex:Me+2})))),!Be&&!Y&&e.createElement(z.Z,null)),e.createElement(je,{isOpen:q,onClose:ye}))},Se=()=>e.createElement(y.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(D,null))},35301:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=[]},78413:(ee,L,t)=>{t.d(L,{Z:()=>ge});var e=t(67294),y=t(49212),s=t(72899),l=t.n(s),c=t(36182),M=t(22522),Ce=t.n(M),se=t(27298),W=t.n(se),z=t(69483);const v="https://cloud.strapi.io/profile/billing",pe="https://strapi.io/billing/request-seats",ge=()=>{const{formatMessage:ie}=(0,y.useIntl)(),{license:E}=(0,z.q5)(),{licenseLimitStatus:F,enforcementUserCount:Z,permittedSeats:re,isHostedOnStrapiCloud:ne}=E?.data??{};return re?e.createElement(s.GridItem,{col:6,s:12},e.createElement(s.Typography,{variant:"sigma",textColor:"neutral600"},ie({id:"Settings.application.admin-seats",defaultMessage:"Admin seats"})),e.createElement(s.Stack,{spacing:2,horizontal:!0},e.createElement(s.Flex,null,e.createElement(s.Typography,{as:"p"},ie({id:"Settings.application.ee.admin-seats.count",defaultMessage:"<text>{enforcementUserCount}</text>/{permittedSeats}"},{permittedSeats:re,enforcementUserCount:Z,text:Fe=>e.createElement(s.Typography,{fontWeight:"semiBold",textColor:Z>re?"danger500":null},Fe)}))),F==="OVER_LIMIT"&&e.createElement(s.Tooltip,{description:ie({id:"Settings.application.ee.admin-seats.at-limit-tooltip",defaultMessage:"At limit: add seats to invite more users"})},e.createElement(s.Icon,{width:`${(0,se.pxToRem)(14)}rem`,height:`${(0,se.pxToRem)(14)}rem`,color:"danger500",as:M.ExclamationMarkCircle}))),e.createElement(c.r,{href:ne?v:pe,isExternal:!0,endIcon:e.createElement(M.ExternalLink,null)},ie({id:"Settings.application.ee.admin-seats.add-seats",defaultMessage:"{isHostedOnStrapiCloud, select, true {Add seats} other {Contact sales}}"},{isHostedOnStrapiCloud:ne}))):null}},26789:(ee,L,t)=>{t.d(L,{Z:()=>je});var e=t(67294),y=t(47292),s=t(27298),l=t(72899),c=t(22522),M=t(80831),Ce=t(27361),se=t.n(Ce),W=t(41609),z=t.n(W),v=t(49212),pe=t(49656),te=t(71893),ge=t(28834),ie=t(48474),E=t(87751),F=t(53209);const re=F.Ry().shape({name:F.Z_().required(s.translatedErrors.required),description:F.Z_().required(s.translatedErrors.required)}),ne=te.default.div`
  border: 1px solid ${({theme:x})=>x.colors.primary200};
  background: ${({theme:x})=>x.colors.primary100};
  padding: ${({theme:x})=>`${x.spaces[2]} ${x.spaces[4]}`};
  color: ${({theme:x})=>x.colors.primary600};
  border-radius: ${({theme:x})=>x.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,Fe=()=>{const x=(0,s.useNotification)(),{lockApp:le,unlockApp:H}=(0,s.useOverlayBlocker)(),{formatMessage:f}=(0,v.useIntl)(),[D,Q]=(0,e.useState)(!1),{replace:Se}=(0,pe.useHistory)(),P=(0,e.useRef)(),{trackUsage:w}=(0,s.useTracking)(),Y=(0,pe.useRouteMatch)("/settings/roles/duplicate/:id"),q=se()(Y,"params.id",null),{isLoading:ye,data:b}=(0,ie.U_)(),{permissions:de,isLoading:Be}=(0,ie.Dq)(q),ke=Me=>{le(),Q(!0),w(q?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,s.request)("/admin/roles",{method:"POST",body:Me})).then(async K=>{const{permissionsToSend:me}=P.current.getPermissions();return w(q?"didDuplicateRole":"didCreateNewRole"),K.data.id&&!z()(me)&&await(0,s.request)(`/admin/roles/${K.data.id}/permissions`,{method:"PUT",body:{permissions:me}}),K}).then(K=>{Q(!1),x({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Se(`/settings/roles/${K.data.id}`)}).catch(K=>{console.error(K),Q(!1),x({type:"warning",message:{id:"notification.error"}})}).finally(()=>{H()})},ue=`${f({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,y.format)(new Date,"PPP")}`;return e.createElement(l.Main,null,e.createElement(s.SettingsPageTitle,{name:"Roles"}),e.createElement(M.Formik,{initialValues:{name:"",description:ue},onSubmit:ke,validationSchema:re,validateOnChange:!1},({handleSubmit:Me,values:K,errors:me,handleReset:Ue,handleChange:We})=>e.createElement(s.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(l.HeaderLayout,{primaryAction:e.createElement(l.Stack,{horizontal:!0,spacing:2},e.createElement(l.Button,{variant:"secondary",onClick:()=>{Ue(),P.current.resetForm()},size:"L"},f({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(l.Button,{onClick:Me,loading:D,size:"L"},f({id:"global.save",defaultMessage:"Save"}))),title:f({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:f({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(s.Link,{startIcon:e.createElement(c.ArrowLeft,null),to:"/settings/roles"},f({id:"global.back",defaultMessage:"Back"}))}),e.createElement(l.ContentLayout,null,e.createElement(l.Stack,{spacing:6},e.createElement(l.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(l.Stack,{spacing:4},e.createElement(l.Flex,{justifyContent:"space-between"},e.createElement(l.Box,null,e.createElement(l.Box,null,e.createElement(l.Typography,{fontWeight:"bold"},f({id:"global.details",defaultMessage:"Details"}))),e.createElement(l.Box,null,e.createElement(l.Typography,{variant:"pi",textColor:"neutral600"},f({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(ne,null,f({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(l.Grid,{gap:4},e.createElement(l.GridItem,{col:6},e.createElement(l.TextInput,{name:"name",error:me.name&&f({id:me.name}),label:f({id:"global.name",defaultMessage:"Name"}),onChange:We,value:K.name})),e.createElement(l.GridItem,{col:6},e.createElement(l.Textarea,{label:f({id:"global.description",defaultMessage:"Description"}),name:"description",error:me.description&&f({id:me.description}),onChange:We},K.description))))),!ye&&!Be?e.createElement(l.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(ge.Z,{isFormDisabled:!1,ref:P,permissions:de,layout:b})):e.createElement(l.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(s.LoadingIndicatorPage,null))))))))};function je(){return e.createElement(s.CheckPagePermissions,{permissions:E.Z.settings.roles.create},e.createElement(Fe,null))}},53273:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!1},20591:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!1},74512:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!1},76766:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!1},85822:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!1},8629:(ee,L,t)=>{t.d(L,{Z:()=>y});const y=!1},64527:(ee,L,t)=>{t.d(L,{Z:()=>je});var e=t(67294),y=t(27298),s=t(87751),l=t(22522),c=t(72899),M=t(96486),Ce=t(63852),se=t(49212),W=t(49656),z=t(48474),v=t(67500),pe=t(52351),te=t(18172);const ge={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},E=(x,le)=>(0,te.default)(x,H=>{switch(le.type){case"ON_REMOVE_ROLES":{H.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{H.shouldRefetchData=!0,H.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{H.shouldRefetchData=!1,H.roleToDelete=null,H.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{H.roleToDelete=le.id;break}default:return H}}),F=()=>{(0,y.useFocusWhenNavigate)();const{isLoading:x,allowedActions:{canCreate:le,canDelete:H,canRead:f,canUpdate:D}}=(0,y.useRBAC)(s.Z.settings.roles),{getData:Q,roles:Se,isLoading:P}=(0,z.bF)(!1),[{query:w}]=(0,y.useQueryParams)(),Y=w?._q||"",q=(0,Ce.ZP)(Se,Y,{keys:["name","description"]});return(0,e.useEffect)(()=>{!x&&f&&Q()},[x,f,Q]),{isLoadingForPermissions:x,canCreate:le,canDelete:H,canRead:f,canUpdate:D,isLoading:P,getData:Q,sortedRoles:q,roles:Se}},Z=({getData:x,canCreate:le,canDelete:H,canUpdate:f})=>{const{formatMessage:D}=(0,se.useIntl)(),Q=(0,y.useNotification)(),[Se,P]=(0,e.useState)(!1),{push:w}=(0,W.useHistory)(),[{selectedRoles:Y,showModalConfirmButtonLoading:q,roleToDelete:ye},b]=(0,e.useReducer)(E,ge),{post:de}=(0,y.getFetchClient)(),Be=async()=>{try{b({type:"ON_REMOVE_ROLES"}),await de("/admin/roles/batch-delete",{ids:[ye]}),await x(),b({type:"RESET_DATA_TO_DELETE"})}catch(_){const Te=(0,M.get)(_,["response","payload","data","ids"],null);if(Te&&Array.isArray(Te)){const ct=Te.join(`
`);Q({type:"warning",message:ct})}else Q({type:"warning",message:{id:"notification.error"}})}K()},ke=(0,e.useCallback)(_=>{w(`/settings/roles/duplicate/${_}`)},[w]),ue=()=>w("/settings/roles/new"),Me=(0,e.useCallback)(_=>{b({type:"SET_ROLE_TO_DELETE",id:_}),K()},[]),K=()=>P(_=>!_),me=(0,e.useCallback)(_=>{w(`/settings/roles/${_}`)},[w]),Ue=(0,e.useCallback)((_,Te)=>{_.preventDefault(),_.stopPropagation(),Te.usersCount?Q({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):Me(Te.id)},[Q,Me]),We=(0,e.useCallback)((_,Te)=>{_.preventDefault(),_.stopPropagation(),ke(Te.id)},[ke]),lt=(0,e.useCallback)(_=>[...le?[{onClick:Te=>We(Te,_),label:D({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(l.Duplicate,null)}]:[],...f?[{onClick:()=>me(_.id),label:D({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(l.Pencil,null)}]:[],...H?[{onClick:Te=>Ue(Te,_),label:D({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(l.Trash,null)}]:[]],[D,Ue,We,me,le,f,H]);return{handleNewRoleClick:ue,getIcons:lt,selectedRoles:Y,isWarningDeleteAllOpened:Se,showModalConfirmButtonLoading:q,handleToggleModal:K,handleDeleteData:Be}},ne=()=>{const{formatMessage:x}=(0,se.useIntl)(),{isLoadingForPermissions:le,canCreate:H,canRead:f,canDelete:D,canUpdate:Q,isLoading:Se,getData:P,sortedRoles:w}=F(),{handleNewRoleClick:Y,getIcons:q,isWarningDeleteAllOpened:ye,showModalConfirmButtonLoading:b,handleToggleModal:de,handleDeleteData:Be}=Z({getData:P,canCreate:H,canDelete:D,canUpdate:Q}),ke=w.length+1,ue=6;if(le)return e.createElement(c.Main,null,e.createElement(y.LoadingIndicatorPage,null));const Me=x({id:"global.roles",defaultMessage:"roles"});return e.createElement(c.Main,null,e.createElement(y.SettingsPageTitle,{name:"Roles"}),e.createElement(c.HeaderLayout,{primaryAction:H?e.createElement(c.Button,{onClick:Y,startIcon:e.createElement(l.Plus,null),size:"S"},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:Me,subtitle:x({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),f&&e.createElement(c.ActionLayout,{startActions:e.createElement(y.SearchURLQuery,{label:x({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:Me})})}),f&&e.createElement(c.ContentLayout,null,e.createElement(c.Table,{colCount:ue,rowCount:ke,footer:H?e.createElement(c.TFooter,{onClick:Y,icon:e.createElement(l.Plus,null)},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(c.Thead,null,e.createElement(c.Tr,{"aria-rowindex":1},e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.name",defaultMessage:"Name"}))),e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.description",defaultMessage:"Description"}))),e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},x({id:"global.users",defaultMessage:"Users"}))),e.createElement(c.Th,null,e.createElement(c.VisuallyHidden,null,x({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(c.Tbody,null,w?.map((K,me)=>e.createElement(pe.Z,{key:K.id,id:K.id,name:K.name,description:K.description,usersCount:K.usersCount,icons:q(K),rowIndex:me+2})))),!ke&&!Se&&e.createElement(v.Z,null)),e.createElement(y.ConfirmDialog,{isOpen:ye,onConfirm:Be,isConfirmButtonLoading:b,onToggleDialog:de}))},je=()=>e.createElement(y.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(ne,null))},5420:(ee,L,t)=>{t.d(L,{Z:()=>y});const e=[];strapi.features.isEnabled(strapi.features.SSO)&&e.push({async Component(){return await t.e(302).then(t.bind(t,40316))},to:"/settings/single-sign-on",exact:!0}),strapi.features.isEnabled(strapi.features.AUDIT_LOGS)&&e.push({async Component(){return await t.e(2812).then(t.bind(t,35915))},to:"/settings/audit-logs",exact:!0});const y=e},78324:(ee,L,t)=>{t.d(L,{Q:()=>H});var e=t(85893),y=t(67294),s=t(71893),l=t(21817),c=t(63507);const M="success-light",Ce="danger-light",se="default",W="tertiary",z="secondary",v="danger",pe="success",te="ghost",ge=[M,Ce],ie=[se,W,z,v,pe,te,...ge],E=null;var F=t(75515);const Z=f=>f===M||f===Ce?`${f.substring(0,f.lastIndexOf("-"))}`:f===W?"neutral":f===se||f===z||ie.every(D=>D!==f)?"primary":`${f}`,re=({theme:f})=>`
    border: 1px solid ${f.colors.neutral200};
    background: ${f.colors.neutral150};
    ${F.Z} {
      color: ${f.colors.neutral600};
    }
    svg {
      > g, path {
        fill: ${f.colors.neutral600};
      }
    }
  `,ne=({theme:f,variant:D})=>[...ge,z].includes(D)?`
      background-color: ${f.colors.neutral0};
    `:D===W?`
      background-color: ${f.colors.neutral100};
    `:D===te?`
      background-color: ${f.colors.neutral100};
    `:D===se?`
      border: 1px solid ${f.colors.buttonPrimary500};
      background: ${f.colors.buttonPrimary500};
    `:`
    border: 1px solid ${f.colors[`${Z(D)}500`]};
    background: ${f.colors[`${Z(D)}500`]};
  `,Fe=({theme:f,variant:D})=>[...ge,z].includes(D)?`
      background-color: ${f.colors.neutral0};
      border: 1px solid ${f.colors[`${Z(D)}600`]};
      ${F.Z} {
        color: ${f.colors[`${Z(D)}600`]};
      }
      svg {
        > g, path {
          fill: ${f.colors[`${Z(D)}600`]};
        }
      }
    `:D===W?`
      background-color: ${f.colors.neutral150};
    `:`
    border: 1px solid ${f.colors[`${Z(D)}600`]};
    background: ${f.colors[`${Z(D)}600`]};
  `,je=({theme:f,variant:D})=>{switch(D){case Ce:case M:case z:return`
          border: 1px solid ${f.colors[`${Z(D)}200`]};
          background: ${f.colors[`${Z(D)}100`]};
          ${F.Z} {
            color: ${f.colors[`${Z(D)}700`]};
          }
          svg {
            > g, path {
              fill: ${f.colors[`${Z(D)}700`]};
            }
          }
        `;case W:return`
          border: 1px solid ${f.colors.neutral200};
          background: ${f.colors.neutral0};
          ${F.Z} {
            color: ${f.colors.neutral800};
          }
          svg {
            > g, path {
              fill: ${f.colors.neutral800};
            }
          }
        `;case te:return`
        border: 1px solid transparent;
        background: transparent;

        ${F.Z} {
          color: ${f.colors.neutral800};
        }

        svg {
          > g, path {
            fill: ${f.colors.neutral500};
          }
        }
      `;case pe:case v:return`
          border: 1px solid ${f.colors[`${Z(D)}600`]};
          background: ${f.colors[`${Z(D)}600`]};
          ${F.Z} {
            color: ${f.colors.neutral0};
          }
        `;default:return`
          svg {
            > g, path {
              fill: ${f.colors.buttonNeutral0};
            }
          }
        `}};var x=t(11047);const le=(0,s.default)(l.G)`
  text-decoration: none;

  &[aria-disabled='true'] {
    ${re}
    &:active {
      ${re}
    }
  }

  &:hover {
    ${ne}
  }

  &:active {
    ${Fe}
  }

  ${je}
`,H=y.forwardRef(({variant:f="default",startIcon:D,endIcon:Q,disabled:Se=!1,children:P,size:w="S",as:Y=c.f,...q},ye)=>{const b=w==="S"?2:"10px",de=4;return(0,e.jsxs)(le,{ref:ye,"aria-disabled":Se,size:w,variant:f,background:"buttonPrimary600",borderColor:"buttonPrimary600",hasRadius:!0,gap:2,inline:!0,paddingBottom:b,paddingLeft:de,paddingRight:de,paddingTop:b,pointerEvents:Se?"none":void 0,...q,as:Y||c.f,children:[D&&(0,e.jsx)(x.k,{"aria-hidden":!0,children:D}),(0,e.jsx)(F.Z,{variant:w==="S"?"pi":void 0,fontWeight:"bold",textColor:"buttonNeutral0",children:P}),Q&&(0,e.jsx)(x.k,{"aria-hidden":!0,children:Q})]})});H.displayName="LinkButton"}}]);
