"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[3650],{60648:(ae,T,t)=>{t.r(T),t.d(T,{default:()=>Bt});var e=t(67294),x=t(40720),i=t(32638),R=t(64593),S=t(86896),P=t(16550),Ae=t(4396),I=t(18206),c=t(63955),U=t(16607),z=t(71068),Ze=t(71590),Te=t(55040),xe=t(12803),j=t(96208),Pe=t(34726),ne=t(6498),D=t(96987),De=t(22304),Oe=t(26910),Re=t(40989),Ie=t(96869),Ue=t(25373),ze=t(2382),se=t(36232),Qe=t(73727),H=t(1565),be=t(70572),Ve=t(21050),We=t(4114),Q=t(28742),$e=t(52805),Ge=t(45697),m=t.n(Ge);const K=({pagination:n})=>e.createElement(U.x,{paddingTop:6},e.createElement(D.k,{alignItems:"flex-end",justifyContent:"space-between"},e.createElement(i.PageSizeURLQuery,null),e.createElement(i.PaginationURLQuery,{pagination:n})));K.defaultProps={pagination:{pageCount:0,pageSize:10,total:0}},K.propTypes={pagination:m().shape({page:m().number,pageCount:m().number,pageSize:m().number,total:m().number})};var je=t(45687),He=t(31358),Ke=t(19839),v=t(11727),Ne=t(54314),Je=t(40426),Xe=t(41801),Ye=t(60269),ke=t(93593),Z=t(12473),we=t(54425),qe=t(29731);const le=({selected:n,onSuccess:l})=>{const{formatMessage:o}=(0,S.Z)(),[r,d]=(0,e.useState)(!1),{isLoading:u,remove:g}=(0,qe.K)(),E=async()=>{await g(n),l()};return e.createElement(e.Fragment,null,e.createElement(Z.z,{variant:"danger-light",size:"S",startIcon:e.createElement(we.Z,null),onClick:()=>d(!0)},o({id:"global.delete",defaultMessage:"Delete"})),e.createElement(i.ConfirmDialog,{isConfirmButtonLoading:u,isOpen:r,onToggleDialog:()=>d(!1),onConfirm:E}))};le.propTypes={selected:m().arrayOf(v.pw,v.nx).isRequired,onSuccess:m().func.isRequired};var _e=t(18053),oe=t(74622),re=t(71543),et=t(74863),tt=t(36854),at=t(31988),nt=t(17734),st=t(37022),lt=t(41054),ot=t(41609),rt=t.n(ot),ie=t(88767);const it=()=>{const n=(0,i.useNotification)(),l=(0,ie.useQueryClient)(),{post:o}=(0,i.useFetchClient)(),r=({destinationFolderId:g,filesAndFolders:E})=>{const f=E.reduce((h,M)=>{const{id:s,type:B}=M,p=B==="asset"?"fileIds":"folderIds";return h[p]||(h[p]=[]),h[p].push(s),h},{});return o("/upload/actions/bulk-move",{...f,destinationFolderId:g})},d=(0,ie.useMutation)(r,{onSuccess(g){const{data:{data:E}}=g;E?.files?.length>0&&(l.refetchQueries([I.Z,"assets"],{active:!0}),l.refetchQueries([I.Z,"asset-count"],{active:!0})),l.refetchQueries([I.Z,"folders"],{active:!0}),n({type:"success",message:{id:(0,c.OB)("modal.move.success-label"),defaultMessage:"Elements have been moved successfully."}})}});return{...d,move:(g,E)=>d.mutateAsync({destinationFolderId:g,filesAndFolders:E})}};var dt=t(81138),ct=t(71381);const N=({onClose:n,selected:l,currentFolder:o})=>{const{formatMessage:r}=(0,S.Z)(),{data:d,isLoading:u}=(0,dt.v)(),{move:g}=it();if(!d)return null;const E=async(M,{setErrors:s})=>{try{await g(M.destination.value,l),n()}catch(B){const b=(0,i.normalizeAPIError)(B).errors.reduce((V,F)=>(V[F.values?.path?.length||"destination"]=F.defaultMessage,V),{});rt()(b)||s(b)}},f=()=>{n()};if(u)return e.createElement(oe.P,{onClose:f,labelledBy:"title"},e.createElement(re.f,null,e.createElement(D.k,{justifyContent:"center",paddingTop:4,paddingBottom:4},e.createElement(et.a,null,r({id:(0,c.OB)("content.isLoading"),defaultMessage:"Content is loading."})))));const h={destination:{value:o?.id||"",label:o?.name||d[0].label}};return e.createElement(oe.P,{onClose:f,labelledBy:"title"},e.createElement(lt.J9,{validateOnChange:!1,onSubmit:E,initialValues:h},({values:M,errors:s,setFieldValue:B})=>e.createElement(i.Form,{noValidate:!0},e.createElement(tt.x,null,e.createElement(z.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"title"},r({id:(0,c.OB)("modal.folder.move.title"),defaultMessage:"Move elements to"}))),e.createElement(re.f,null,e.createElement(at.r,{gap:4},e.createElement(ne.P,{xs:12,col:12},e.createElement(D.k,{direction:"column",alignItems:"stretch",gap:1},e.createElement(nt.Q,{htmlFor:"folder-destination"},r({id:(0,c.OB)("form.input.label.folder-location"),defaultMessage:"Location"})),e.createElement(ct.Z,{options:d,onChange:p=>{B("destination",p)},defaultValue:M.destination,name:"destination",menuPortalTarget:document.querySelector("body"),inputId:"folder-destination",error:s?.destination,ariaErrorMessage:"destination-error"}),s.destination&&e.createElement(z.Z,{variant:"pi",as:"p",id:"folder-destination-error",textColor:"danger600"},s.destination))))),e.createElement(st.m,{startActions:e.createElement(Z.z,{onClick:f,variant:"tertiary",name:"cancel"},r({id:"cancel",defaultMessage:"Cancel"})),endActions:e.createElement(Z.z,{type:"submit",loading:u},r({id:"modal.folder.move.submit",defaultMessage:"Move"}))}))))};N.defaultProps={currentFolder:void 0},N.propTypes={onClose:m().func.isRequired,currentFolder:v.nx,selected:m().arrayOf(v.nx,v.pw).isRequired};const J=({selected:n,onSuccess:l,currentFolder:o})=>{const{formatMessage:r}=(0,S.Z)(),[d,u]=(0,e.useState)(!1),g=()=>{u(!1),l()};return e.createElement(e.Fragment,null,e.createElement(Z.z,{variant:"secondary",size:"S",startIcon:e.createElement(_e.Z,null),onClick:()=>u(!0)},r({id:"global.move",defaultMessage:"Move"})),d&&e.createElement(N,{currentFolder:o,onClose:g,selected:n}))};J.defaultProps={currentFolder:void 0},J.propTypes={onSuccess:m().func.isRequired,currentFolder:v.nx,selected:m().arrayOf(v.pw,v.nx).isRequired};const X=({selected:n,onSuccess:l,currentFolder:o})=>{const{formatMessage:r}=(0,S.Z)();return e.createElement(D.k,{gap:2,paddingBottom:5},e.createElement(z.Z,{variant:"epsilon",textColor:"neutral600"},r({id:(0,ke.Z)("list.assets.selected"),defaultMessage:"{numberFolders, plural, one {1 folder} other {# folders}} - {numberAssets, plural, one {1 asset} other {# assets}} selected"},{numberFolders:n.filter(({type:d})=>d==="folder").length,numberAssets:n.filter(({type:d})=>d==="asset").length})),e.createElement(le,{selected:n,onSuccess:l}),e.createElement(J,{currentFolder:o,selected:n,onSuccess:l}))};X.defaultProps={currentFolder:void 0},X.propTypes={onSuccess:m().func.isRequired,currentFolder:v.nx,selected:m().arrayOf(v.pw,v.nx).isRequired};var ut=t(59288),Y=t(83598),mt=t(54053);const gt=({isFiltering:n,canCreate:l,canRead:o})=>n?{id:"list.assets-empty.title-withSearch",defaultMessage:"There are no elements with the applied filters"}:o?l?{id:"list.assets.empty-upload",defaultMessage:"Upload your first assets..."}:{id:"list.assets.empty",defaultMessage:"Media Library is empty"}:{id:"header.actions.no-permissions",defaultMessage:"No permissions to view"},de=({canCreate:n,isFiltering:l,canRead:o,onActionClick:r})=>{const{formatMessage:d}=(0,S.Z)(),u=gt({isFiltering:l,canCreate:n,canRead:o});return e.createElement(mt.i,{icon:o?null:ut.Z,action:n&&!l&&e.createElement(Z.z,{variant:"secondary",startIcon:e.createElement(Y.Z,null),onClick:r},d({id:(0,c.OB)("header.actions.add-assets"),defaultMessage:"Add new assets"})),content:d({...u,id:(0,c.OB)(u.id)})})};de.propTypes={canCreate:m().bool.isRequired,canRead:m().bool.isRequired,isFiltering:m().bool.isRequired,onActionClick:m().func.isRequired};var ft=t(52933),vt=t(99398),Et=t(32269),ce=t(62082);const ht=()=>{const n=(0,e.useRef)(null),[l,o]=(0,e.useState)(!1),{formatMessage:r}=(0,S.Z)(),{trackUsage:d}=(0,i.useTracking)(),[{query:u},g]=(0,i.useQueryParams)(),E=u?.filters?.$and||[],f=()=>o(s=>!s),h=s=>{g({filters:{$and:s},page:1})},M=s=>{d("didFilterMediaLibraryElements",{location:"content-manager",filter:Object.keys(s[s.length-1])[0]}),g({filters:{$and:s},page:1})};return e.createElement(e.Fragment,null,e.createElement(Z.z,{variant:"tertiary",ref:n,startIcon:e.createElement(ft.Z,null),onClick:f,size:"S"},r({id:"app.utils.filters",defaultMessage:"Filters"})),l&&e.createElement(Et.Z,{displayedFilters:ce.Z,filters:E,onSubmit:M,onToggle:f,source:n}),e.createElement(vt.Z,{appliedFilters:E,filtersSchema:ce.Z,onRemoveFilter:h}))};var pt=t(90731),yt=t(29824),Ct=t(97695),Mt=t(25514);const k=({breadcrumbs:n,canCreate:l,folder:o,onToggleEditFolderDialog:r,onToggleUploadAssetDialog:d})=>{const{formatMessage:u}=(0,S.Z)(),{pathname:g}=(0,P.TH)(),[{query:E}]=(0,i.useQueryParams)(),f={...E,folder:o?.parent?.id??void 0,folderPath:o?.parent?.path??void 0};return e.createElement(pt.T,{title:u({id:(0,c.OB)("plugin.name"),defaultMessage:"Media Library"}),subtitle:n&&o&&e.createElement(Mt.O,{as:"nav",label:u({id:(0,c.OB)("header.breadcrumbs.nav.label"),defaultMessage:"Folders navigation"}),breadcrumbs:n,currentFolderId:o?.id}),navigationAction:o&&e.createElement(yt.r,{startIcon:e.createElement(Ct.Z,null),to:`${g}?${(0,se.stringify)(f,{encode:!1})}`},u({id:(0,c.OB)("header.actions.folder-level-up"),defaultMessage:"Back"})),primaryAction:l&&e.createElement(D.k,{gap:2},e.createElement(Z.z,{startIcon:e.createElement(Y.Z,null),variant:"secondary",onClick:r},u({id:(0,c.OB)("header.actions.add-folder"),defaultMessage:"Add new folder"})),e.createElement(Z.z,{startIcon:e.createElement(Y.Z,null),onClick:d},u({id:(0,c.OB)("header.actions.add-assets"),defaultMessage:"Add new assets"})))})};k.defaultProps={breadcrumbs:!1,folder:null},k.propTypes={breadcrumbs:m().oneOfType([v.Fv,m().bool]),canCreate:m().bool.isRequired,folder:v.nx,onToggleEditFolderDialog:m().func.isRequired,onToggleUploadAssetDialog:m().func.isRequired};const Ft=(0,H.ZP)(U.x)`
  height: ${32/16}rem;
  display: flex;
  align-items: center;
`,ue=(0,H.ZP)(z.Z)`
  max-width: 100%;
`,me=(0,H.ZP)(U.x)`
  svg {
    path {
      fill: ${({theme:n})=>n.colors.neutral500};
    }
  }
`,Lt=()=>{const{push:n}=(0,P.k6)(),{canRead:l,canCreate:o,canUpdate:r,canCopyLink:d,canDownload:u,isLoading:g}=(0,Ye.y)(),E=(0,e.useRef)(),{formatMessage:f}=(0,S.Z)(),{pathname:h}=(0,P.TH)(),{trackUsage:M}=(0,i.useTracking)(),[{query:s},B]=(0,i.useQueryParams)(),p=Boolean(s._q||s.filters),[b,V]=(0,i.usePersistentState)(v.uf.view,v.Uk.GRID),F=b===v.Uk.GRID,{data:L,isLoading:At,errors:Zt}=(0,Ne.L)({skipWhen:!l,query:s}),{data:Tt,isLoading:xt,errors:Pt}=(0,Xe.j)({enabled:l&&L?.pagination?.page===1&&!(0,c.rV)(s),query:s}),{data:w,isLoading:ge,error:Dt}=(0,Je.W)(s?.folder,{enabled:l&&!!s?.folder});Dt?.response?.status===404&&n(h);const W=Tt?.map(a=>({...a,type:"folder",folderURL:(0,c.Km)(h,s,a.id),isSelectable:r}))??[],y=W?.length||0,$=L?.results?.map(a=>({...a,type:"asset",isSelectable:r}))||[],C=$?.length??0,Ot=L?.pagination?.total,fe=ge||xt||g||At,[Rt,It]=(0,e.useState)(!1),[Ut,ve]=(0,e.useState)(!1),[Ee,q]=(0,e.useState)(void 0),[_,he]=(0,e.useState)(void 0),[A,{selectOne:G,selectAll:pe}]=(0,i.useSelectionState)(["type","id"],[]),ye=A?.length>0&&A?.length!==C+y,ee=()=>It(a=>!a),Ce=({created:a=!1}={})=>{a&&s?.page!=="1"&&B({...s,page:1}),ve(O=>!O)},Me=(a,O)=>{a.target.checked&&M("didSelectAllMediaLibraryElements"),pe(O)},Fe=a=>{M("didSortMediaLibraryElements",{location:"upload",sort:a}),B({sort:a})},Le=a=>{he(a),ve(!0)},zt=a=>{he(null),Ce(a),E.current&&E.current.focus()},Se=a=>{a===C&&L.pagination.page===L.pagination.pageCount&&L.pagination.page>1&&B({...s,page:L.pagination.page-1})},Qt=()=>{pe(),Se(A.length)};return(0,i.useFocusWhenNavigate)(),e.createElement(Ze.A,null,e.createElement(x.o,{"aria-busy":fe},e.createElement(k,{breadcrumbs:!ge&&(0,c.M4)(w,{pathname:h,query:s}),canCreate:o,onToggleEditFolderDialog:Ce,onToggleUploadAssetDialog:ee,folder:w}),e.createElement(Te.Z,{startActions:e.createElement(e.Fragment,null,r&&F&&(C>0||y>0)&&e.createElement(Ft,{paddingLeft:2,paddingRight:2,background:"neutral0",hasRadius:!0,borderColor:"neutral200"},e.createElement(xe.C,{"aria-label":f({id:(0,c.OB)("bulk.select.label"),defaultMessage:"Select all folders & assets"}),indeterminate:ye,value:(C>0||y>0)&&A.length===C+y,onChange:a=>Me(a,[...$,...W])})),l&&F&&e.createElement(je.Z,{value:s?.sort,onChangeSort:Fe}),l&&e.createElement(ht,null)),endActions:e.createElement(e.Fragment,null,e.createElement(i.CheckPermissions,{permissions:v._I.configureView},e.createElement(me,{paddingTop:1,paddingBottom:1},e.createElement(j.h,{forwardedAs:Qe.rU,to:{pathname:`${h}/configuration`,search:(0,se.stringify)(s,{encode:!1})},icon:e.createElement(Re.Z,null),label:f({id:"app.links.configure-view",defaultMessage:"Configure the view"})}))),e.createElement(me,{paddingTop:1,paddingBottom:1},e.createElement(j.h,{icon:F?e.createElement(Ie.Z,null):e.createElement(Ue.Z,null),label:f(F?{id:(0,c.OB)("view-switch.list"),defaultMessage:"List View"}:{id:(0,c.OB)("view-switch.grid"),defaultMessage:"Grid View"}),onClick:()=>V(F?v.Uk.LIST:v.Uk.GRID)})),e.createElement(i.SearchURLQuery,{label:f({id:(0,c.OB)("search.label"),defaultMessage:"Search for an asset"}),trackedEvent:"didSearchMediaLibraryElements",trackedEventDetails:{location:"upload"}}))}),e.createElement(Pe.D,null,A.length>0&&e.createElement(X,{currentFolder:w,selected:A,onSuccess:Qt}),fe&&e.createElement(i.LoadingIndicatorPage,null),(Zt||Pt)&&e.createElement(i.AnErrorOccurred,null),y===0&&C===0&&e.createElement(de,{canCreate:o,canRead:l,isFiltering:p,onActionClick:ee}),l&&!F&&(C>0||y>0)&&e.createElement(He.b,{assetCount:C,folderCount:y,indeterminate:ye,onChangeSort:Fe,onChangeFolder:(a,O)=>n((0,c.Km)(h,s,{folder:a,folderPath:O})),onEditAsset:q,onEditFolder:Le,onSelectOne:G,onSelectAll:Me,rows:[...W,...$],selected:A,shouldDisableBulkSelect:!r,sortQuery:s?.sort??""}),l&&F&&e.createElement(e.Fragment,null,y>0&&e.createElement($e.a,{title:(p&&C>0||!p)&&f({id:(0,c.OB)("list.folders.title"),defaultMessage:"Folders ({count})"},{count:y})||""},W.map(a=>{const bt=!!A.filter(({type:te})=>te==="folder").find(te=>te.id===a.id),Be=(0,c.Km)(h,s,{folder:a?.id,folderPath:a?.path});return e.createElement(ne.P,{col:3,key:`folder-${a.id}`},e.createElement(Q.Ac,{ref:_&&a.id===_.id?E:void 0,ariaLabel:a.name,id:`folder-${a.id}`,to:Be,startAction:G&&a.isSelectable?e.createElement(Q.MM,{"data-testid":`folder-checkbox-${a.id}`,value:bt,onChange:()=>G(a)}):null,cardActions:e.createElement(j.h,{icon:e.createElement(ze.Z,null),"aria-label":f({id:(0,c.OB)("list.folder.edit"),defaultMessage:"Edit folder"}),onClick:()=>Le(a)})},e.createElement(Q.Bu,null,e.createElement(Q.u6,{to:Be},e.createElement(D.k,{as:"h2",direction:"column",alignItems:"start",maxWidth:"100%"},e.createElement(ue,{fontWeight:"semiBold",ellipsis:!0},a.name,e.createElement(De.T,null,":")),e.createElement(ue,{as:"span",textColor:"neutral600",variant:"pi",ellipsis:!0},f({id:(0,c.OB)("list.folder.subtitle"),defaultMessage:"{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"},{folderCount:a.children.count,filesCount:a.files.count})))))))})),C>0&&y>0&&e.createElement(U.x,{paddingTop:6,paddingBottom:4},e.createElement(Oe.i,null)),C>0&&e.createElement(be.r,{assets:$,onEditAsset:q,onSelectAsset:G,selectedAssets:A.filter(({type:a})=>a==="asset"),title:(!p||p&&y>0)&&L?.pagination?.page===1&&f({id:(0,c.OB)("list.assets.title"),defaultMessage:"Assets ({count})"},{count:Ot})||""})),L?.pagination&&e.createElement(K,{pagination:L.pagination}))),Rt&&e.createElement(Ke.x,{onClose:ee,trackedLocation:"upload",folderId:s?.folder}),Ut&&e.createElement(We.f,{onClose:zt,folder:_,parentFolderId:s?.folder,location:"upload"}),Ee&&e.createElement(Ve.s,{onClose:a=>{a===null&&Se(1),q(void 0)},asset:Ee,canUpdate:r,canCopyLink:d,canDownload:u,trackedLocation:"upload"}))},St=(0,e.lazy)(()=>t.e(9514).then(t.bind(t,47670))),Bt=()=>{const{config:{isLoading:n,isError:l,data:o}}=(0,Ae.Z)(),[{rawQuery:r},d]=(0,i.useQueryParams)(),{formatMessage:u}=(0,S.Z)(),g=u({id:(0,c.OB)("plugin.name"),defaultMessage:"Media Library"});return(0,e.useEffect)(()=>{n||l||r||d({sort:o.sort,page:1,pageSize:o.pageSize})},[n,l,o,r,d]),(0,i.useFocusWhenNavigate)(),e.createElement(x.o,{"aria-busy":n},e.createElement(R.q,{title:g}),n&&e.createElement(i.LoadingIndicatorPage,null),r?e.createElement(e.Suspense,{fallback:e.createElement(i.LoadingIndicatorPage,null)},e.createElement(P.rs,null,e.createElement(P.AW,{exact:!0,path:`/plugins/${I.Z}`,component:Lt}),e.createElement(P.AW,{exact:!0,path:`/plugins/${I.Z}/configuration`,render:()=>e.createElement(St,{config:o})}))):null)}},97695:(ae,T,t)=>{t.d(T,{Z:()=>i});var e=t(85893);const x=R=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...R,children:(0,e.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),i=x},40989:(ae,T,t)=>{t.d(T,{Z:()=>i});var e=t(85893);const x=R=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...R,children:(0,e.jsx)("path",{fill:"#212134",fillRule:"evenodd",d:"M2.68 9.192c-.6.276-2.114 1.18-2.306 1.303a.792.792 0 0 0-.374.68v1.65a.797.797 0 0 0 .384.687c.254.16 1.73 1.042 2.306 1.303l.744 1.8c-.24.634-.67 2.333-.72 2.554a.797.797 0 0 0 .216.744l1.167 1.166a.801.801 0 0 0 .744.216l.03-.008c.36-.092 1.946-.498 2.523-.712l1.8.744c.276.6 1.181 2.115 1.304 2.307a.805.805 0 0 0 .679.374h1.649a.797.797 0 0 0 .686-.384c.16-.254 1.042-1.73 1.303-2.306l1.8-.744c.634.24 2.333.67 2.554.72a.797.797 0 0 0 .744-.216l1.166-1.167a.803.803 0 0 0 .216-.744l-.008-.03c-.092-.36-.498-1.946-.712-2.523l.744-1.8c.6-.276 2.115-1.181 2.307-1.304a.804.804 0 0 0 .374-.679v-1.649a.796.796 0 0 0-.382-.679c-.254-.16-1.73-1.041-2.306-1.303l-.744-1.8c.24-.634.67-2.333.72-2.554a.796.796 0 0 0-.216-.744l-1.166-1.173a.802.802 0 0 0-.744-.216l-.03.008c-.361.092-1.947.498-2.524.712l-1.8-.744c-.276-.6-1.18-2.115-1.303-2.307a.803.803 0 0 0-.68-.374h-1.65a.797.797 0 0 0-.68.382c-.16.254-1.041 1.73-1.303 2.306l-1.8.744c-.634-.24-2.333-.67-2.554-.72a.797.797 0 0 0-.744.216L2.921 4.094a.802.802 0 0 0-.216.744l.008.03c.092.361.498 1.947.712 2.524l-.744 1.8ZM12 17a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z",clipRule:"evenodd"})}),i=x}}]);
